<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' *.twitter.com unpkg.com www.googletagmanager.com www.google-analytics.com *.twimg.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline' *.twitter.com *.twimg.com">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2017/rediscovering-visual-studio-snippets">
		<meta name="description" content="I've been using the built-in code snippets in Visual Studio for years, but for some reason until last week it had never crossed my mind to work out how to create my own. After getting bored writing the same chunk of code too often, I was reminded of the old saying &quot;You should automate any task you have to do more than once&quot;.  So I decided to have a go at some snippets. Turns out it's both a useful trick to know, and not hard to do:">
		<meta property="og:description" content="I've been using the built-in code snippets in Visual Studio for years, but for some reason until last week it had never crossed my mind to work out how to create my own. After getting bored writing the same chunk of code too often, I was reminded of the old saying &quot;You should automate any task you have to do more than once&quot;.  So I decided to have a go at some snippets. Turns out it's both a useful trick to know, and not hard to do:">
		<meta name="keywords" content="Visual Studio">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - (Re)Discovering Visual Studio&nbsp;Snippets</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta property="og:title" content="Jeremy Davis - (Re)Discovering Visual Studio&amp;#xA0;Snippets">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/rediscovering-visual-studio-snippets-social.jpg">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "(Re)Discovering Visual Studio&#xA0;Snippets",
        "image": [
            "https://blog.jermdavis.dev/img/featured/rediscovering-visual-studio-snippets-social.jpg"
        ],
        "datePublished": "2017-01-09T00:00:00+00:00",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2017/rediscovering-visual-studio-snippets">
		<meta property="og:type" content="website">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/scss/tailwind.css" rel="stylesheet">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/scss/site-theme.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
		
		<!-- 18/07/2022 08:16:40 -->
	</head>
	<body class="max-w-7xl mx-auto">
		<div class="relative bg-white" x-data="{ open: false }">
			
			<!-- desktop -->
			<div class="px-4 lg:px-6 bg-gray-100">
				<div class="flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">
					<div class="flex justify-start lg:w-0 flex-1">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav -mr-2 -my-2 lg:hidden">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							
							<!-- Heroicon name: outline/menu -->
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav hidden lg:flex space-x-10">
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>
					</nav>
				</div>
			</div>
			
			<!--Mobile menu, show/hide based on mobile menu state.-->
			<div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">
				<div class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
					<div class="pt-5 pb-6 px-5">
						<div class="flex items-center justify-between">
							<div class="flex">
								<a href="/">
									<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav -mr-2">
								<button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav py-6 px-5 pt-0">
						<nav class=" gap-x-8">
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="background-image: url(&amp;quot;/&amp;quot;);">
			<div class="post-heading">
				<div class="url p-1 bg-gray-100 rounded-md">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2017/rediscovering-visual-studio-snippets</tt>
				</div>
				<h1 class="text-5xl mb-4 pb-1">
					(Re)Discovering Visual Studio&nbsp;Snippets
				</h1>
				<div class="meta">Published 09 January 2017</div>
				<div class="flex py-1">
					<a href="/tags/visual-studio/" class="p-1 mr-1 bg-gray-100 rounded-md">
						Visual Studio</a>
				</div>
			</div>
		</header>
		<div class="py-2 lg:pl-3">
			<div class="lg:flex">
				<div class="lg:flex-auto mx-3 lg:min-w-0 content">
					<p>I've been using the built-in code snippets in Visual Studio for years, but for some reason until last week it had never crossed my mind to work out how to create my own. After getting bored writing the same chunk of code too often, I was reminded of the old saying "You should automate any task you have to do more than once".  So I decided to have a go at some snippets. Turns out it's both a useful trick to know, and not hard to do:
						<!--more-->
					</p>
					<h2>Getting started</h2>
					<p>The urge to investigate creating snippets came from realising I was typing out something similar to this code fragment too much:</p>
					<pre data-enlighter-language="csharp" style="width:100%; overflow:scroll;">if (SomeVariable == null)
{
    throw new ArgumentNullException(nameof(SomeVariable));
}

					</pre>
					<p>So I wanted to wrap that up in a way that made it easy to fill in the variable.</p>
					<h2>MSDN to the rescue!</h2>
					<p>Having
						<a href="https://msdn.microsoft.com/en-us/library/ms165393(v=vs.100).aspx" target="_blank" rel="noopener noreferrer">done a bit of research</a>, it turns out snippets are defined as XML documents. Each one consists of a
						<code>&lt;Header/&gt;</code>
						element that describes metadata about your snippet, and a
						<code>&lt;Snippet/&gt;</code>
						element that tells Visual Studio what to do when the snippet gets inserted. These are wrapped up in parent elements that describe a collection of snippets. The outer elements look like:</p>
					<pre data-enlighter-language="xml" style="width:100%; overflow:scroll;">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet"&gt;
  &lt;CodeSnippet Format="1.0.0"&gt;
    &lt;!-- header element goes here --&gt;
    &lt;!-- snippet element goes here --&gt;
  &lt;/CodeSnippet&gt;
&lt;/CodeSnippets&gt;

					</pre>
					<p>The
						<code>&lt;CodeSnippet/&gt;</code>
						element can be repeated if you have more than one snippet to define in your file.</p>
					<p>The header section describes visible metadata for the author of the snippet and the description of its purpose. It also provides the information Visual Studio uses to decide when to insert the snippet and how to process it. For example:</p>
					<pre data-enlighter-language="xml" style="width:100%; overflow:scroll;">&lt;Header&gt;
  &lt;Title&gt;Null check a method parameter&lt;/Title&gt;
  &lt;Author&gt;Jeremy Davis&lt;/Author&gt;
  &lt;Description&gt;Creates an if() block that checks for null, and throws ArgumentNullException if so.&lt;/Description&gt;
  &lt;Shortcut&gt;ifnull&lt;/Shortcut&gt;
  &lt;SnippetTypes&gt;
    &lt;SnippetType&gt;Expansion&lt;/SnippetType&gt;
  &lt;/SnippetTypes&gt;
&lt;/Header&gt;

					</pre>
					<p>The
						<code>&lt;Shortcut&gt;</code>
						element defines the bit of text that gets registered with autocomplete to let you invoke the snippet as you type. For example, starting to type the shortcut above gives:</p>
					<p>
						<a href="/img/2016/2016-12-helptext.png" target="_blank">
							<img alt="Help Text" src="/img/2016/2016-12-helptext.png">
						</a>
					</p>
					<p>The
						<code>&lt;SnippetTypes&gt;</code>
						element lets you list the types of behaviour you want to associate with this entry. The two you can use are
						<code>Expansion</code>
						(which is a standard snippet that just gets inserted at the current cursor position) and
						<code>SurroundsWith</code>
						(which allows the snippet text to be wrapped around your current selection by right-clicking and selecting "Snippet / Surround With" from the context menu). You can specify both if it's appropriate for your code.</p>
					<p>In the
						<code>&lt;Snippet&gt;</code>
						element has two important sections to consider. The
						<code>&lt;Declarations&gt;</code>
						element lets you describe any replaceable parameters in your snippet (like variable names) and finally the
						<code>&lt;Code&gt;</code>
						element declares the text of your snippet. (There is a third element allowed here called
						<code>&lt;References&gt;</code>
						- but that is only used with Visual Basic snippets)</p>
					<p>For this example:</p>
					<pre data-enlighter-language="xml" style="width:100%; overflow:scroll;">&lt;Snippet&gt;
  &lt;Declarations&gt;
    &lt;Object&gt;
      &lt;ID&gt;parameter&lt;/ID&gt;
      &lt;Default&gt;MethodParameter&lt;/Default&gt;
      &lt;ToolTip&gt;The name of the parameter you wish to test for null&lt;/ToolTip&gt;
    &lt;/Object&gt;
  &lt;/Declarations&gt;
  &lt;Code Language="CSharp"&gt;&lt;![CDATA[if($parameter$ == null)
            {
                throw new ArgumentNullException(nameof($parameter$));
            }$end$]]&gt;&lt;/Code&gt;
&lt;/Snippet&gt;

					</pre>
					<p>The
						<code>&lt;code/&gt;</code>
						element for the snippet needs to declare which language your text is for, and it should contain a
						<code>CDATA</code>
						section to ensure that the code it contains doesn't get messed up by being in XML. Whitespace in this section will be inserted as part of the snippet, so keeping the
						<code>CDATA</code>
						declaration and the start of the snippet on the same line will prevent extra blank lines in front of the code. The same goes for the end of the
						<code>CDATA</code>
						section.</p>
					<p>There are some special tokens which you can add here - which are identified by being surrounded by dollar signs. The token
						<code>$end$</code>
						specifies where you want the cursor to end up after the snippet is inserted and any parameters have been resolved. (Chances are, this is at the end of your snippet so that you can insert it and continue typing the rest of the code easily) The
						<code>$selected$</code>
						token identifies where the selected text should go if you insert it as a "surround with" snippet. And then you can define further tokens that you want the user to fill in when your snippet gets inserted – such as
						<code>$parameter$</code>
						above. These tokens need to be defined in the
						<code>&lt;Declarations&gt;</code>
						section.</p>
					<p>Each of your custom tokens needs an
						<code>&lt;Object&gt;</code>
						element under
						<code>&lt;Declarations&gt;</code>. For each of these you have to declare an
						<code>&lt;ID&gt;</code>
						(which matches the token in your snippet text, but without the dollars), a
						<code>&lt;Default&gt;</code>
						(which is the text that will be inserted by Visual Studio and then highlighted yellow to show that the user has some text to fill in) and a
						<code>&lt;ToolTip&gt;</code>
						for help. For example, the XML above gives:</p>
					<p>
						<a href="/img/2016/2016-12-replaceparameter.png" target="_blank">
							<img alt="Replace Parameter" src="/img/2016/2016-12-replaceparameter.png">
						</a>
					</p>
					<p>As with the standard snippets, typing over one of the bits of yellow default text and hitting enter will replace all instances of that token with your new text.</p>
					<h2>Getting installed</h2>
					<p>Once you've created a snippet file, you can install it into Visual Studio via the
						<code>Tools / Code Snippets Manager</code>
						menu option:</p>
					<p>
						<a href="/img/2016/2016-12-importsnippet.png" target="_blank">
							<img alt="Import Snippet" src="/img/2016/2016-12-importsnippet.png">
						</a>
					</p>
					<p>Click the "Import" button to select your file.</p>
					<p>To import a snippet you don't have to adjust the "Language" dropdown – it will file the snippet in the right place based on the metadata described above. But you do need to change that if you want to find your snippets in the UI.</p>
					<p>Once you've imported your file, it will be available for use straight away. To experiment,
						<a href="https://1drv.ms/u/s!Aksy3xP00GvLkJAA20blGKqxyvPdwg" target="_blank" rel="noopener noreferrer">you can download my example here</a>
						if you wish.</p>
					<h2>And onwards...</h2>
					<p>And from there, it's just a matter of thinking up things you might use a snippet for. For you Sitecore readers, how about
						<a href="https://1drv.ms/u/s!Aksy3xP00GvLkJABNHpAdSk6Bb0wvQ" target="_blank" rel="noopener noreferrer">surrounding a block of code with a user switcher</a>?</p>
					<p>
						<a href="/img/2016/2016-12-1472c906-8c51-47f1-b22e-bdeb075738ba.gif" target="_blank">
							<img alt="" src="/img/2016/2016-12-1472c906-8c51-47f1-b22e-bdeb075738ba.gif">
						</a>
					</p>
					<p>[<i>And yes, before anyone feels the need to get too pedantic, I know that: a) you probably wouldn't want to use a constant string for the user here – that's just to simplify the example and b) that
							<code>\</code>
							is creating a tab and hence messing up the username – that's a typo I've not had time to correct</i>]</p>
					<p>I'm sure there are plenty more examples to be thought up...</p>
				</div>
				<div class="sidebar lg:flex-none lg:w-72 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
					<section class="mvp">
						<h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2022</h3>
						<div class="bg-white mb-2 p-2">
							<a href="/mvp">
								<img src="/img/mvp/2022.jpg" width="219" height="219" alt="2022 MVP Badge">
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Top Tags</h3>
						<div class="bg-white p-2 flex flex-wrap">
							<a href="/tags/sitecore/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Sitecore (203)</a>
							<a href="/tags/c/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								C# (47)</a>
							<a href="/tags/powershell/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								PowerShell (31)</a>
							<a href="/tags/installation/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Installation (23)</a>
							<a href="/tags/solr/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Solr (15)</a>
							<a href="/tags/general/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								General (14)</a>
							<a href="/tags/ui/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								UI (14)</a>
							<a href="/tags/docker/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Docker (12)</a>
							<a href="/tags/coveo/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Coveo (12)</a>
							<a href="/tags/packages/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Packages (11)</a>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/tags" role="button">All Tags
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Recent Months</h3>
						<div class="bg-white p-2">
							<div>
								<a class="text-lg" href="/posts/2022-07">2022 - July</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2022-06">2022 - June</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2022-05">2022 - May</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2022-04">2022 - April</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2022-03">2022 - March</a>
							</div>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/posts" role="button">All Posts
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Twitter</h3>
						<div class="bg-white mb-2 p-2">
							<a class="twitter-timeline" data-height="400" data-chrome="noheader nofooter noborders" href="https://twitter.com/jermdavis">Tweets by JermDavis</a>
							<script async="" defer="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
						</div>
					</section>
				</div>
			</div>
		</div>
		<footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
			<div class="flex-1 lg:flex-1 text-center lg:text-left">
				<div>©
					<a target="_blank" class="font-medium text-gray-500 hover:text-gray-900" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2022</div>
			</div>
			<div class="lg:flex-1 lg:order-3 text-center lg:text-right">
				<a class="font-medium text-gray-500 hover:text-gray-900" href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
				<li class="inline-block">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
				<div class="w-full text-lg">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.7.1.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
        EnlighterJS.init('pre', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
    
		</script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>