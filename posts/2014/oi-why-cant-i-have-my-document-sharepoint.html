<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="/js/theme.js"></script>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' unpkg.com www.googletagmanager.com *.google-analytics.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline'; frame-src https://www.youtube.com/">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">
		<meta name="description" content="Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my &quot;Local Intranet&quot; sites in Internet Explorer.
Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:">
		<meta property="og:description" content="Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my &quot;Local Intranet&quot; sites in Internet Explorer.
Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:">
		<meta name="keywords" content="SharePoint">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Oi! Why can't I have my document,&nbsp;SharePoint?</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta name="fediverse:creator" content="@jermdavis@mastodon.social">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Oi! Why can't I have my document,&nbsp;SharePoint? [by Jeremy Davis]">
		<meta property="og:publish_date" content="2014-11-24T00:00:00+0000">
		<meta property="article:published_time" content="2014-11-24T00:00:00+0000">
		<meta property="og:modified_date" content="2018-09-27T00:00:00+0000">
		<meta property="article:modified_time" content="2018-09-27T00:00:00+0000">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/oi-why-cant-i-have-my-document-sharepoint-social.jpg">
		<meta property="og:image:alt" content="Logo image showing post title 'Oi! Why can't I have my document,&nbsp;SharePoint?' and author 'Jeremy Davis'">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Oi! Why can't I have my document, SharePoint?",
        "url": "https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint",
        "image": [
            {
                "@type": "ImageObject",
                "contentUrl": "https://blog.jermdavis.dev/img/featured/oi-why-cant-i-have-my-document-sharepoint-social.jpg",
                "caption": "Logo image showing post title 'Oi! Why can't I have my document, SharePoint?' and author 'Jeremy Davis'"
            }
        ],
        "datePublished": "2014-11-24T00:00:00+0000",
        "dateModified": "2018-09-27T00:00:00+0000",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/dist/main.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="blog" x-bind:class="dk ? 'dark' : ''" id="top">
		<div id="rp-bar"></div>
		<div class="blogNavContainer" x-data="{ open: false }">
			<div class="blogNav">
				<div class="bannerContainer">
					<div class="bannerRow">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav navBurger">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav navItemSet">
						<a href="/posts">Posts</a>
						<a href="/tags">Tags</a>
						<a href="/about">About</a>
						<a href="/links">Useful Links</a>
						<a href="/mvp">MVP</a>
						<a href="/search">Search</a>
						<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
							<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
							<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
							<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
						</button>
					</nav>
				</div>
			</div>
			<div class="mobileContainer">
				<div style="display:none;" class="popupBox" x-show="open" x-transition="">
					<div class="popupHead">
						<div class="popupHeadInner">
							<div class="titleRow">
								<a href="/">
									<img width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav menuRow">
								<button @click="open = false" type="button">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav popupItemsOuter">
						<nav class="gap-x-8">
							<a href="/posts">Posts</a>
							<a href="/tags">Tags</a>
							<a href="/about">About</a>
							<a href="/links">Useful Links</a>
							<a href="/mvp">MVP</a>
							<a href="/search">Search</a>
							<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
								<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
								<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
								<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
							</button>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="headerContainer" style="">
			<div class="post-heading">
				<div class="url printBanner">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint</tt>
				</div>
				<h1>
					Oi! Why can't I have my document,&nbsp;SharePoint?
				</h1>
				<div class="meta">Published 24 November 2014</div>
				<div class="meta">Updated 27 September 2018</div>
				<div class="tagList">
					<a href="/tags/sharepoint/">
						SharePoint</a>
					<span>~2 min. read</span>
				</div>
			</div>
		</header>
		<div class="blogContainerOuter">
			<div class="blogContainerInner">
				<div class="leftCol content">
					<p>Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my "Local Intranet" sites in Internet Explorer.</p>
					<p>Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:
						<!--more-->
					</p>
					<p>It doesn't really make sense at first: I click a document in SharePoint and get this:</p>
					<p>
						<a href="/img/2014/2014-11-doclist1.png" target="_blank">
							<img alt="Doc List" src="/img/2014/2014-11-doclist1.png">
						</a>
					</p>
					<p>I know I'm logged in to the network, I know that the DNS name for the SharePoint site is in my IE "Local Intranet" sites and I know that "automatic logon" is allowed for those sites. So why the login dialog?</p>
					<p>After a bit of rooting around the Internet, and the usual game of "what are the correct Google keywords for my problem" I came across a Microsoft Knowledge Base article:
						<a target="_blank" rel="noopener noreferrer" href="http://support.microsoft.com/kb/943280">KB943280</a>
						"Prompt for Credentials When Accessing FQDN Sites From a Windows Vista or Windows 7 Computer". Whilst this dates from 2011, this has allowed me to work out the issue.</p>
					<p>It turns out to be down to how Windows accesses
						<a href="http://en.wikipedia.org/wiki/WebDAV" target="_blank" rel="noopener noreferrer">WebDAV</a>
						shares. The Windows components that are used to access WebDAV are not the same ones that IE uses to deal with ordinary HTTP requests. So while you may be using IE (and its security settings) to access the SharePoint site, the attempt to load the document from SharePoint itself uses the "Windows HTTP Services" components by default – and crucially these never look at the IE Security settings.</p>
					<p>These alternative components are configured to only ever send username and password information to sites that appear to be local. And it decides what "local" is based on the URL. If it's just a server name, i.e.:
						<code>http://MyServer/document.docx</code>
						then that's local. If it's a fully qualified DNS name, i.e.
						<code>http://myserver.mycompany.com/document.docx</code>
						then that's remote and security data will not be sent automatically.</p>
					<p>And that's the root of the issue – I'm a full-time remote worker. Hence I am accessing SharePoint via a fully qualified DNS name since NetBIOS / WINS names don't work for me on the end of a VPN tunnel.</p>
					<p>So how do I fix this?</p>
					<p>I suppose I could just create a
						<a href="https://en.wikipedia.org/wiki/Hosts_%28file%29" target="_blank" rel="noopener noreferrer">HOSTS</a>
						file entry for the NetBIOS name of the SharePoint server. But that seems a bit inelegant. Load balancing, virtual machines or just a plain old migration to a new version make it seem more likely that eventually the IP address would change and I'd be confused for a while about why SharePoint appeared broken. Rather than hiding the symptom, I need to fix the underlying issue.</p>
					<p>Reading through the Knowledge Base article above, it talks about two things. Firstly, a patch to change the behaviour of the Windows HTTP Services components to allow configuration to override this setting. And secondly it talks about the registry settings you can use.</p>
					<p>Since the article was last revised years ago, I tried a quick test to see if the code in the hotfix was already present in my (well patched) install of Windows 7. Turns out that it is – so chances are you can skip the patching bit of the KB article if you're running a recent release of Windows. I'm not sure about Windows 8, as I don't have a machine to try it on, however.</p>
					<p>The article talks about adding a single registry setting. Under
						<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters</code>
						cretae a new "Multi-String value" entry called
						<code>AuthForwardServerList</code>. Modify its value, and enter DNS names for the server(s) you want to be treated as Local Intranet sites for the purposes of WebDAV.</p>
					<p>You can use wildcards, protocols etc if you want, but make sure you think about the security implications of your settings. For example having
						<code>http://myserver.*</code>
						is a security risk, as this means WebDAV requests to a server named
						<code>myserver.nastyhacker.com</code>
						would get authentication data sent automatically. There is more detail about the security implications in the article, so if you're not sure read the details.</p>
					<p>Having added the setting:</p>
					<p>
						<a href="/img/2014/2014-11-setting.png" target="_blank">
							<img alt="Setting" src="/img/2014/2014-11-setting.png">
						</a>
					</p>
					<p>And then restarted the
						<code>WebClient</code>
						service:</p>
					<p>
						<a href="/img/2014/2014-11-restartservice.png" target="_blank">
							<img alt="Restart Service" src="/img/2014/2014-11-restartservice.png">
						</a>
					</p>
					<p>I can now click files in SharePoint and not have to enter my credentials. Success.</p>
					<a class="gotop" href="#top">↑ Back to top</a>
					<ul class="shares">
						<li>
							<b>Feel like sharing?</b>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://bsky.app/intent/compose?text=Oi! Why can&amp;#x27;t I have my document,&amp;#xA0;SharePoint?%20https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">On BlueSky</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">On LinkedIn</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://mastodonshare.com/?text=Oi! Why can&amp;#x27;t I have my document,&amp;#xA0;SharePoint?&amp;url=https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">On Mastodon</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" data-no-validate="data-no-validate" href="mailto:&amp;body=Oi! Why can&amp;#x27;t I have my document,&amp;#xA0;SharePoint?%20https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">On Email</a>
						</li>
						<li></li>
					</ul>
				</div>
				<div class="rightCol sidebar">
					<div class="barContainer">
						<section class="mvp">
							<h3>Sitecore MVP 2015-2025</h3>
							<div>
								<a href="/mvp">
									<img class="l" src="/img/mvp/program.png" width="219" height="219" alt="2025 MVP Badge">
									<img class="d" src="/img/mvp/program_d.png" width="219" height="219" alt="2025 MVP Badge">
								</a>
							</div>
						</section>
						<section class="recentTags">
							<h3>Recent Tags</h3>
							<div>
								<a href="/tags/c/">
									C#
								</a>
								<a href="/tags/sitecore/">
									Sitecore
								</a>
								<a href="/tags/presentation/">
									Presentation
								</a>
								<a href="/tags/mvc/">
									MVC
								</a>
								<a href="/tags/razor/">
									Razor
								</a>
								<a href="/tags/net/">
									.Net
								</a>
								<a href="/tags/forms/">
									Forms
								</a>
								<a href="/tags/saas/">
									SaaS
								</a>
								<a href="/tags/bug/">
									Bug
								</a>
								<a href="/tags/windows/">
									Windows
								</a>
							</div>
						</section>
						<section class="topTags">
							<h3>Top Tags</h3>
							<div class="list">
								<a href="/tags/sitecore/">
									Sitecore (248)</a>
								<a href="/tags/platform-dxp/">
									Platform DXP (216)</a>
								<a href="/tags/c/">
									C# (72)</a>
								<a href="/tags/powershell/">
									PowerShell (33)</a>
								<a href="/tags/installation/">
									Installation (23)</a>
								<a href="/tags/docker/">
									Docker (20)</a>
								<a href="/tags/general/">
									General (19)</a>
								<a href="/tags/solr/">
									Solr (19)</a>
								<a href="/tags/containers/">
									Containers (17)</a>
								<a href="/tags/net/">
									.Net (15)</a>
							</div>
							<div class="link">
								<a href="/tags" role="button">All Tags &gt;</a>
							</div>
						</section>
						<section class="months">
							<h3>Recent Months</h3>
							<div class="list">
								<a href="/posts/2025-10">2025 - October</a>
								<a href="/posts/2025-09">2025 - September</a>
								<a href="/posts/2025-08">2025 - August</a>
								<a href="/posts/2025-07">2025 - July</a>
								<a href="/posts/2025-06">2025 - June</a>
							</div>
							<div class="link">
								<a href="/posts" role="button">All Months &gt;</a>
							</div>
						</section>
						<section class="socials">
							<h3>Socials</h3>
							<div>
								<table>
									<tbody>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													<img src="/img/bluesky.png" width="32" height="32" alt="Bluesky Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													Bluesky
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													<img src="/img/linkedin.png" width="32" height="32" alt="LinkedIn Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													LinkedIn
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													<img src="/img/slack.png" width="32" height="32" alt="Sitecore Slack Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													Sitecore Slack
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													<img src="/img/mastodon.png" width="32" height="32" alt="Mastodon Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													Mastodon
												</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
		<footer class="footerContainer">
			<div class="copyright">
				<div>©
					<a target="_blank" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2025</div>
			</div>
			<div class="statiq">
				<a href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="feeds">
				<li>
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li>
					<a target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li>
					<a target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div x-cloak="" class="cookieContainer" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="panel">
				<div class="link">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="btn" aria-label="Dismiss">
					Understood
				</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.13.3.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script defer="" src="/vendor/rp/rpbar-1.0.js"></script>
		<script defer="" src="/js/post.js"></script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>