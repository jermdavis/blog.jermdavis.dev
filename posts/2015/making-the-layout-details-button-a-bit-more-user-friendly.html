<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' unpkg.com www.googletagmanager.com *.google-analytics.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline'">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2015/making-the-layout-details-button-a-bit-more-user-friendly">
		<meta name="description" content="The idea that everything in your Sitecore content tree is &quot;an item&quot; is great once you understand how it works, but can be a bit confusing to people who are new to the software. It's a fairly common new-user mistake to set Layout Details on a Template item, rather than on the Standard Values item for the template. This leads to all sorts of &quot;but why are my changes not visible on the website?&quot; confusion.
<a href=&quot;/img/2015/2015-02-layoutdetailsmistake.png&quot; target=&quot;_blank&quot;><img alt=&quot;Layout Details Mistake&quot; src=&quot;/img/2015/2015-02-layoutdetailsmistake.png&quot;></a>
Talking about this with a colleague a while back, I wondered if there was a way of trying to reduce the likelihood of this sort of mistake for new users. Here's a quick example of an idea I came up with: ">
		<meta property="og:description" content="The idea that everything in your Sitecore content tree is &quot;an item&quot; is great once you understand how it works, but can be a bit confusing to people who are new to the software. It's a fairly common new-user mistake to set Layout Details on a Template item, rather than on the Standard Values item for the template. This leads to all sorts of &quot;but why are my changes not visible on the website?&quot; confusion.
<a href=&quot;/img/2015/2015-02-layoutdetailsmistake.png&quot; target=&quot;_blank&quot;><img alt=&quot;Layout Details Mistake&quot; src=&quot;/img/2015/2015-02-layoutdetailsmistake.png&quot;></a>
Talking about this with a colleague a while back, I wondered if there was a way of trying to reduce the likelihood of this sort of mistake for new users. Here's a quick example of an idea I came up with: ">
		<meta name="keywords" content="Sitecore, UI">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Making the Layout Details button a bit more user&nbsp;friendly</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta property="og:title" content="Jeremy Davis - Making the Layout Details button a bit more user&amp;#xA0;friendly">
		<meta property="og:publish_date" content="2015-03-09T00:00:00+00:00">
		<meta property="og:type" content="article">
		<meta property="og:modified_date" content="2016-08-25T00:00:00+00:00">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/making-the-layout-details-button-a-bit-more-user-friendly-social.jpg">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Making the Layout Details button a bit more user&#xA0;friendly",
        "url": "https://blog.jermdavis.dev/posts/2015/making-the-layout-details-button-a-bit-more-user-friendly",
        "image": [
            "https://blog.jermdavis.dev/img/featured/making-the-layout-details-button-a-bit-more-user-friendly-social.jpg"
        ],
        "datePublished": "2015-03-09T00:00:00+00:00",
        "dateModified": "2016-08-25T00:00:00+00:00",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2015/making-the-layout-details-button-a-bit-more-user-friendly">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/scss/tailwind.css" rel="stylesheet">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/scss/site-theme.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="max-w-7xl mx-auto text-black" id="top">
		<div class="relative bg-white" x-data="{ open: false }">
			
			<!-- desktop -->
			<div class="px-4 lg:px-6 bg-gray-100">
				<div class="bannerContainer flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">
					<div class="flex justify-start lg:w-0 flex-1">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav -mr-2 -my-2 lg:hidden">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							
							<!-- Heroicon name: outline/menu -->
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav hidden lg:flex space-x-10">
						<a class="text-base font-medium" href="/posts">Posts</a>
						<a class="text-base font-medium" href="/tags">Tags</a>
						<a class="text-base font-medium" href="/about">About</a>
						<a class="text-base font-medium" href="/links">Useful Links</a>
						<a class="text-base font-medium" href="/mvp">MVP</a>
					</nav>
				</div>
			</div>
			
			<!--Mobile menu, show/hide based on mobile menu state.-->
			<div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">
				<div class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
					<div class="pt-5 pb-6 px-5">
						<div class="flex items-center justify-between">
							<div class="flex">
								<a href="/">
									<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav -mr-2">
								<button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav py-6 px-5 pt-0">
						<nav class=" gap-x-8">
							<a class="block mt-5 text-base font-medium" href="/posts">Posts</a>
							<a class="block mt-5 text-base font-medium" href="/tags">Tags</a>
							<a class="block mt-5 text-base font-medium" href="/about">About</a>
							<a class="block mt-5 text-base font-medium" href="/links">Useful Links</a>
							<a class="block mt-5 text-base font-medium" href="/mvp">MVP</a>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="">
			<div class="post-heading">
				<div class="url p-1 bg-gray-100 rounded-md">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2015/making-the-layout-details-button-a-bit-more-user-friendly</tt>
				</div>
				<h1 class="text-5xl mb-4 pb-1">
					Making the Layout Details button a bit more user&nbsp;friendly
				</h1>
				<div class="meta">Published 09 March 2015</div>
				<div class="meta">Updated 25 August 2016</div>
				<div class="flex py-1">
					<a href="/tags/sitecore/" class="p-1 mr-1 bg-gray-100 rounded-md">
						Sitecore</a>
					<a href="/tags/ui/" class="p-1 mr-1 bg-gray-100 rounded-md">
						UI</a>
				</div>
			</div>
		</header>
		<div class="py-2 lg:pl-3">
			<div class="lg:flex">
				<div class="lg:flex-auto mx-3 lg:min-w-0 content">
					<p>The idea that everything in your Sitecore content tree is "an item" is great once you understand how it works, but can be a bit confusing to people who are new to the software. It's a fairly common new-user mistake to set Layout Details on a Template item, rather than on the Standard Values item for the template. This leads to all sorts of "but why are my changes not visible on the website?" confusion.</p>
					<p>
						<a href="/img/2015/2015-02-layoutdetailsmistake.png" target="_blank">
							<img alt="Layout Details Mistake" src="/img/2015/2015-02-layoutdetailsmistake.png">
						</a>
					</p>
					<p>Talking about this with a colleague a while back, I wondered if there was a way of trying to reduce the likelihood of this sort of mistake for new users. Here's a quick example of an idea I came up with: 
						<!--more-->
					</p>
					<p>If you look at the Core Database's definitions for the Content Editor ribbon then you'll find the information about what commands are bound to the Details and Reset buttons for Layout.</p>
					<p>Under
						<code>/sitecore/content/Applications/Content Editor/Ribbons/Chunks/Layout/Details</code>
						you find:</p>
					<p>
						<a href="/img/2015/2015-02-setlayoutdetails.png" target="_blank">
							<img alt="SetLayoutDetails" src="/img/2015/2015-02-setlayoutdetails.png">
						</a>
					</p>
					<p>And when you look up these two buttons' commands in the
						<code>commands.config</code>
						file you will find:</p>
					<pre class="code" data-enlighter-language="csharp" style="width:100%; overflow:scroll;">&lt;command name="item:setlayoutdetails" type="Sitecore.Shell.Framework.Commands.SetLayoutDetails,Sitecore.Kernel" /&gt;
&lt;command name="pagedesigner:reset" type="Sitecore.Shell.Applications.Layouts.PageDesigner.Commands.Reset,Sitecore.Client"/&gt;

					</pre>
					<p>These bits of config map the UI commands to implementation classes which inherit from the base type
						<code>Sitecore.Shell.Framework.Commands.Command</code>
						and this includes a method for
						<code>QueryState()</code>
						which the UI framework calls (passing in the item being edited) so a command can say whether it should be visible or enabled.</p>
					<p>Hence one way we can try and solve our problem is to inherit from the standard Sitecore command classes for these menu options and add in some extra logic. Since both commands need the same logic, we can factor that out into a separate class to avoid writing it twice. For the sake of blog-post simplicity, lets stick it in a static helper method. Something like this:</p>
					<pre class="code" data-enlighter-language="csharp" style="width:100%; overflow:scroll;">public static class SimplerLayoutHelper
{
    public static CommandState QueryState(CommandContext context, Func&lt;CommandContext, CommandState&gt; baseMethod)
    {
        Assert.ArgumentNotNull(context, "context");

        if (context.Items != null &amp;&amp; context.Items.Length == 1)
        {
            Item itm = context.Items[0];

            if (itm.Database.Name != "core")
            {
                Item ancestor = itm.Axes.SelectSingleItem("ancestor::*[@@name='templates' or @@name='content']");
                if (ancestor == null)
                {
                    return CommandState.Disabled;
                }
                if (ancestor.Name == "templates" &amp;&amp; itm.Name != "__Standard Values")
                {
                    return CommandState.Disabled;
                }
            }
        }

        return baseMethod(context);
    }
}

					</pre>
					<p>The method takes the command context, and a function pointer to the base
						<code>QueryState()</code>
						method that we want to fall back to if we decide not to return a result. If we have a context item to work on, it checks we're not in the Core database, as we're not bothered about those items. Then it runs an ancestor query to decide if the item in question is a child of the Templates or Content parts of the tree (the two places where setting Layout Details makes sense).</p>
					<p>If it's not in the right part of the tree then we return the "Disabled" state to grey out the button and prevent them being clicked. If it does have Templates as an ancestor then we make a further check to see if the name of the context item is "__Standard Values". If not, we return Disabled to prevent the layout details being set in the wrong part of the Template tree. And otherwise we just pass the context through to the original method to let Sitecore's code take care of the remaining scenarios.</p>
					<p>The replacement command classes can then be put together very simply:</p>
					<pre class="code" data-enlighter-language="csharp" style="width:100%; overflow:scroll;">public class SimplerLayoutDetails : Sitecore.Shell.Framework.Commands.SetLayoutDetails
{
    public override CommandState QueryState(CommandContext context)
    {
        return SimplerLayoutHelper.QueryState(context, base.QueryState);
    }
}

public class SimplerLayoutReset : Sitecore.Shell.Applications.Layouts.PageDesigner.Commands.Reset
{
    public override CommandState QueryState(CommandContext context)
    {
        return SimplerLayoutHelper.QueryState(context, base.QueryState);
    }
}

					</pre>
					<p>All we need to do is call our helper method and pass in the context and the base method from the original class.</p>
					<p>These new command classes can be configured with a simple config patch:</p>
					<pre class="code" data-enlighter-language="xml" style="width:100%; overflow:scroll;">&lt;configuration xmlns:patch="http://www.sitecore.net/xmlconfig/"&gt;
  &lt;sitecore&gt;
    &lt;commands&gt;
      &lt;command 
        patch:instead="*[@name='item:setlayoutdetails']"
        name="item:setlayoutdetails" 
        type="Testing.SimplerLayoutDetails,Testing" /&gt;

      &lt;command 
        patch:instead="*[@name='pagedesigner:reset']"
        name="pagedesigner:reset" 
        type="Testing.SimplerLayoutReset,Testing"/&gt;
    &lt;/commands&gt;    
  &lt;/sitecore&gt;
&lt;/configuration&gt;

					</pre>
					<p>This just replaces the out-of-the-box Command implementations with the new classes above. With that in place, trying to set the Layout Details on the wrong bit of a template doesn't work any more:</p>
					<p>
						<a href="/img/2015/2015-02-wrongitem.png" target="_blank">
							<img alt="Wrong Item" src="/img/2015/2015-02-wrongitem.png">
						</a>
					</p>
					<p>On the Template item, the buttons are greyed out. But if you select the correct Standard Values item:</p>
					<p>
						<a href="/img/2015/2015-02-rightitem.png" target="_blank">
							<img alt="Right Item" src="/img/2015/2015-02-rightitem.png">
						</a>
					</p>
					<p>And that should help prevent confusion about where to make these settings...</p>
					<a class="gotop" href="#top">↑ Back to top</a>
				</div>
				<div class="sidebar lg:flex-none lg:w-64 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
					<section class="mvp">
						<h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2023</h3>
						<div class="bg-white mb-2 p-2">
							<a href="/mvp">
								<img class="lg:mx-auto" src="/img/mvp/2023.png" width="219" height="219" alt="2023 MVP Badge">
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Top Tags</h3>
						<div class="bg-white p-2 flex flex-wrap">
							<a href="/tags/sitecore/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Sitecore (218)</a>
							<a href="/tags/c/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								C# (54)</a>
							<a href="/tags/powershell/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								PowerShell (31)</a>
							<a href="/tags/installation/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Installation (23)</a>
							<a href="/tags/solr/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Solr (19)</a>
							<a href="/tags/general/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								General (16)</a>
							<a href="/tags/docker/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Docker (16)</a>
							<a href="/tags/ui/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								UI (15)</a>
							<a href="/tags/containers/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Containers (13)</a>
							<a href="/tags/bug/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Bug (12)</a>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/tags" role="button">All Tags
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Recent Months</h3>
						<div class="bg-white p-2">
							<div>
								<a class="text-lg" href="/posts/2023-08">2023 - August</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-07">2023 - July</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-06">2023 - June</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-05">2023 - May</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-04">2023 - April</a>
							</div>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/posts" role="button">All Posts
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Socials</h3>
						<div class="bg-white mb-2 p-2">
							<div>
								<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">Mastodon</a>
							</div>
							<div>
								<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">LinkedIn</a>
							</div>
							<div>
								<a rel="me" target="_blank" href="https://twitter.com/jermdavis">Twitter</a>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
		<footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
			<div class="flex-1 lg:flex-1 text-center lg:text-left">
				<div>©
					<a target="_blank" class="font-medium" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2023</div>
			</div>
			<div class="lg:flex-1 lg:order-3 text-center lg:text-right">
				<a class="font-medium" href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
				<li class="inline-block">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
				<div class="w-full text-lg">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.7.1.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>