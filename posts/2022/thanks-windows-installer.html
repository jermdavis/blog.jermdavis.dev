<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="/js/theme.js"></script>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' unpkg.com www.googletagmanager.com *.google-analytics.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline'">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">
		<meta name="description" content="If you're trying to instale Windows 10, you may have issues picking the version you need thanks to some new UI in the installer. Here's how you can work around this.">
		<meta property="og:description" content="If you're trying to instale Windows 10, you may have issues picking the version you need thanks to some new UI in the installer. Here's how you can work around this.">
		<meta name="keywords" content="Windows">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Thanks Windows Installer - you could have just asked...</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Thanks Windows Installer - you could have just asked... [by Jeremy Davis]">
		<meta property="og:publish_date" content="2021-12-27T00:00:00+0000">
		<meta property="article:published_time" content="2021-12-27T00:00:00+0000">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/thanks-windows-installer-social.jpg">
		<meta property="og:image:alt" content="Logo image showing post title 'Thanks Windows Installer - you could have just asked...' and author 'Jeremy Davis'">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Thanks Windows Installer - you could have just asked...",
        "url": "https://blog.jermdavis.dev/posts/2022/thanks-windows-installer",
        "image": [
            {
                "@type": "ImageObject",
                "contentUrl": "https://blog.jermdavis.dev/img/featured/thanks-windows-installer-social.jpg",
                "caption": "Logo image showing post title 'Thanks Windows Installer - you could have just asked...' and author 'Jeremy Davis'"
            }
        ],
        "datePublished": "2021-12-27T00:00:00+0000",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/dist/main.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="blog" x-bind:class="dk ? 'dark' : ''" id="top">
		<div id="rp-bar"></div>
		<div class="blogNavContainer" x-data="{ open: false }">
			<div class="blogNav">
				<div class="bannerContainer">
					<div class="bannerRow">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav navBurger">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav navItemSet">
						<a href="/posts">Posts</a>
						<a href="/tags">Tags</a>
						<a href="/about">About</a>
						<a href="/links">Useful Links</a>
						<a href="/mvp">MVP</a>
						<a href="/search">Search</a>
						<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
							<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
							<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
							<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
						</button>
					</nav>
				</div>
			</div>
			<div class="mobileContainer">
				<div style="display:none;" class="popupBox" x-show="open" x-transition="">
					<div class="popupHead">
						<div class="popupHeadInner">
							<div class="titleRow">
								<a href="/">
									<img width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav menuRow">
								<button @click="open = false" type="button">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav popupItemsOuter">
						<nav class="gap-x-8">
							<a href="/posts">Posts</a>
							<a href="/tags">Tags</a>
							<a href="/about">About</a>
							<a href="/links">Useful Links</a>
							<a href="/mvp">MVP</a>
							<a href="/search">Search</a>
							<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
								<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
								<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
								<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
							</button>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="headerContainer" style="">
			<div class="post-heading">
				<div class="url printBanner">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2022/thanks-windows-installer</tt>
				</div>
				<h1>
					Thanks Windows Installer - you could have just asked...
				</h1>
				<h2>Sometimes UI 'improvements' don't actually help</h2>
				<div class="meta">Published 27 December 2021</div>
				<div class="tagList">
					<a href="/tags/windows/">
						Windows</a>
					<span>~3 min. read</span>
				</div>
			</div>
		</header>
		<div class="blogContainerOuter">
			<div class="blogContainerInner">
				<div class="leftCol content">
					<p>One of the things I've been doing over the festive period is reinstalling some laptops. While it's usually a slightly tedious job, something Microsoft have done to the Windows Installer of late has made picking the Windows version you want harder than it should be. So I'm leaving myself a note for next time I crash into this problem... 
						<!--more-->
					</p>
					<h2 x-data="" class="anchor">The problem<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading1" name="heading1">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					I needed to install Windows on a shiny new laptop. It had been bought with Windows Home, because there was no "I don't need to buy a new O/S" option in the shop and I already own a Windows 10 Pro license that I wanted to use on it. So it arrived with the usual bloatware installed on Home and needed wiping.
					<p>So I grabbed a USB Stick, downloaded the
						<a rel="noopener" target="_blank" href="https://www.microsoft.com/en-gb/software-download/windows10">Windows Media Creation tool</a>
						and made myself a bootable Windows 10 install stick. (Yes, I am still
						<a rel="noopener" target="_blank" href="https://media.giphy.com/media/STfLOU6iRBRunMciZv/giphy.gif">actively avoiding Windows 11</a>
						for the moment) And then I went through the usualy dance of rebooting, failing to boot from USB, realising the machine ships with only "boot from SSD" enabled and fiddling with the BIOS... But after a bit of tedium I got it to boot the installer, and went through the "delete existing disk partitions" dance to clean out all the stuff that had been shipped on the laptop.</p>
					<p>Microsoft have done a bit of UX optimisation - the installer no longer asks about your license key. In fact it asks more questions about "are you ok with uploading &lt;some bit of data&gt; to Microsoft" than it does about your installation requirements these day.</p>
					<p>After a few minutes (and some annoying shouting from Cortana because the laptop's default volume was "high") it went through the install fine. But when it booted up, I noticed that it was running Windows Home. Which was not what I wanted...</p>
					<h2 x-data="" class="anchor">What's going on?<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading2" name="heading2">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					I turns out that if you're installing with
					<a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a>
					enabled, the installer now looks into some flash memory in your computer to see if you have a built-in windows key shipped by your
					<a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Original_equipment_manufacturer">OEM</a>. Since I'd bought the laptop with Windows Home installed, that's what was in this memory.
					<p>So the installer was happily assuming that was the key I wanted to use for my install, and not giving me an option to change the choice.</p>
					<p>You can see what (if any) key you have stored
						<a href="https://www.nirsoft.net/utils/product_cd_key_viewer.html" rel="noopener" target="_blank">using this viewer tool</a>
						but be aware that as I'm witing this, Windows' built-in virus protection really doesn't seem to like it. Perhaps unsurprisingly, as Microsoft might see poking about in this data as dodgy:</p>
					<p>
						<a target="_blank" href="/img/2022/12-KeyViewerError.png">
							<img src="/img/2022/12-KeyViewerError.png">
						</a>
					</p>
					<p>So you may choose not to go down that road...</p>
					<h2 x-data="" class="anchor">Possible solutions<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading3" name="heading3">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					Having spent an hour or so trawling through google for research, there seem to be two main ways to address this issue:
					<ul>
						<li>
							<p>
								<strong>You can let it install as above, and then use the "change my product key" option in Windows.</strong>
								<br>
								This will work, but it can be a bit of a hassle. Windows installs some different things for Pro compared to Home, and changing the version afterwards does not fix all of this. So if you want the full Pro experience you will need to go through the process of
								<a rel="noopener" target="_blank" href="https://support.microsoft.com/en-us/windows/how-to-refresh-reset-or-restore-your-pc-51391d9a-eb0a-84a7-69e4-c2c1fbceb8dd">reset Windows back to the fresh-install state</a>
								in order to get those extra bits.</p>
						</li>
						<li>
							<p>
								<strong>Or you can make use of the installer's ability to pick up extra "unattended install" data from your install media.</strong>
								<br>
								It is possible to put config on your install device that says "ignore what else you may see, please install Windows Pro". That will make sure all the right files are installed, and you only need to activate the right license key afterwards to get the full Pro experience.</p>
						</li>
					</ul>
					<p>To my mind, the second option here was the better one.</p>
					<p>You need to create a text file named
						<code>EI.cfg</code>
						and put it into the
						<code>sources</code>
						folder on the USB disk that the media creator set up for you. There are lots of options you can set here, using an "ini file" style format. But the key ones to get Pro vs Home are:</p>
					<pre class="code" data-enlighter-theme="droide" data-enlighter-language="text" style="width:100%; overflow:scroll;">[EditionID]
ProfessionalN
[Channel]
Retail
[VL]
0

					</pre>
					<p>You can also choose other versions of Windows (If you wanted the "N" version of Pro perhaps)
						<a href="https://superuser.com/questions/1020961/prevent-windows-10-installer-from-using-the-preinstalled-serial-key-without-disa/1608112#1608112" rel="noopener" target="_blank">using the advice in this Stack Exchange answer</a>.</p>
					<p>Once that file is saved, and you run through the install processs again, you'll get your chosen version. Though it still won't say anything on the screen about which version you're installing.</p>
					<p>But note that once Windows boots up, the "Activation" page in Settings may be a bit unhappy - it will know that the Home key in your BIOS memory isn't valid for the version you have installed, so you'll need to provide your valid Pro product key to allow Windows to activate. If you log in with a Microsoft Account, and you have a Pro key attached to that it may get picked up automatically. But you might need to manually enter the right key on the Activation settings page.</p>
					<p>And with that done, I was able to get back to the fun process of installing useful stuff onto these laptops, and testing out the new hardware with
						<a rel="noopener" target="_blank" href="https://store.steampowered.com/app/846770/DYSMANTLE/">a bit of festive relaxation</a>.</p>
					<a class="gotop" href="#top">↑ Back to top</a>
					<ul class="shares">
						<li>
							<b>Feel like sharing?</b>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://bsky.app/intent/compose?text=Thanks Windows Installer - you could have just asked...%20https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">On BlueSky</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">On LinkedIn</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://mastodonshare.com/?text=Thanks Windows Installer - you could have just asked...&amp;url=https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">On Mastodon</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="mailto:&amp;body=Thanks Windows Installer - you could have just asked...%20https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">On Email</a>
						</li>
						<li></li>
					</ul>
				</div>
				<div class="rightCol sidebar">
					<div class="barContainer">
						<section class="headingSummary">
							<h3>Post Headings</h3>
							<div>
								<ol class="headings">
									<li>
										<a href="#heading1">The problem</a>
									</li>
									<li>
										<a href="#heading2">What's going on?</a>
									</li>
									<li>
										<a href="#heading3">Possible solutions</a>
									</li>
								</ol>
							</div>
						</section>
						<section class="mvp">
							<h3>Sitecore MVP 2015-2025</h3>
							<div>
								<a href="/mvp">
									<img class="l" src="/img/mvp/program.png" width="219" height="219" alt="2025 MVP Badge">
									<img class="d" src="/img/mvp/program_d.png" width="219" height="219" alt="2025 MVP Badge">
								</a>
							</div>
						</section>
						<section class="recentTags">
							<h3>Recent Tags</h3>
							<div>
								<a href="/tags/performance/">
									Performance
								</a>
								<a href="/tags/sitecore/">
									Sitecore
								</a>
								<a href="/tags/visual-studio/">
									Visual Studio
								</a>
								<a href="/tags/caching/">
									Caching
								</a>
								<a href="/tags/platform-dxp/">
									Platform DXP
								</a>
								<a href="/tags/docker/">
									Docker
								</a>
								<a href="/tags/forms/">
									Forms
								</a>
								<a href="/tags/contentsearch/">
									ContentSearch
								</a>
								<a href="/tags/c/">
									C#
								</a>
								<a href="/tags/net/">
									.Net
								</a>
							</div>
						</section>
						<section class="topTags">
							<h3>Top Tags</h3>
							<div class="list">
								<a href="/tags/sitecore/">
									Sitecore (241)</a>
								<a href="/tags/platform-dxp/">
									Platform DXP (215)</a>
								<a href="/tags/c/">
									C# (66)</a>
								<a href="/tags/powershell/">
									PowerShell (32)</a>
								<a href="/tags/installation/">
									Installation (23)</a>
								<a href="/tags/docker/">
									Docker (20)</a>
								<a href="/tags/solr/">
									Solr (19)</a>
								<a href="/tags/general/">
									General (18)</a>
								<a href="/tags/containers/">
									Containers (17)</a>
								<a href="/tags/visual-studio/">
									Visual Studio (15)</a>
							</div>
							<div class="link">
								<a href="/tags" role="button">All Tags &gt;</a>
							</div>
						</section>
						<section class="months">
							<h3>Recent Months</h3>
							<div class="list">
								<a href="/posts/2025-03">2025 - March</a>
								<a href="/posts/2025-02">2025 - February</a>
								<a href="/posts/2025-01">2025 - January</a>
								<a href="/posts/2024-12">2024 - December</a>
								<a href="/posts/2024-11">2024 - November</a>
							</div>
							<div class="link">
								<a href="/posts" role="button">All Months &gt;</a>
							</div>
						</section>
						<section class="socials">
							<h3>Socials</h3>
							<div>
								<table>
									<tbody>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													<img src="/img/bluesky.png" width="32" height="32" alt="Bluesky Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													Bluesky
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													<img src="/img/linkedin.png" width="32" height="32" alt="LinkedIn Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													LinkedIn
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													<img src="/img/slack.png" width="32" height="32" alt="Sitecore Slack Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													Sitecore Slack
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													<img src="/img/mastodon.png" width="32" height="32" alt="Mastodon Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													Mastodon
												</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
		<footer class="footerContainer">
			<div class="copyright">
				<div>©
					<a target="_blank" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2025</div>
			</div>
			<div class="statiq">
				<a href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="feeds">
				<li>
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li>
					<a target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li>
					<a target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div x-cloak="" class="cookieContainer" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="panel">
				<div class="link">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="btn" aria-label="Dismiss">
					Understood
				</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.13.3.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script defer="" src="/vendor/rp/rpbar-1.0.js"></script>
		<script defer="" src="/js/post.js"></script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>