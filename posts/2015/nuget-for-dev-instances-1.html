<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' *.twitter.com unpkg.com www.googletagmanager.com www.google-analytics.com *.twimg.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline' *.twitter.com *.twimg.com">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="Using NuGet for Sitecore dev instances (Part&nbsp;1)">
		<meta property="og:description" content="Using NuGet for Sitecore dev instances (Part&nbsp;1)">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Using NuGet for Sitecore dev instances (Part&nbsp;1)</title>
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2015/nuget-for-dev-instances-1">
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.json">
		<meta property="og:title" content="Jeremy Davis - Using NuGet for Sitecore dev instances (Part&amp;#xA0;1)">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/social-card.png">
		<meta property="og:description" content="Sitecore, C# and web development">
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2015/nuget-for-dev-instances-1">
		<meta property="og:type" content="website">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/scss/tailwind.css" rel="stylesheet">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/scss/site-theme.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defers=""></script>
		
		<!-- 23/01/2022 10:19:08 -->
	</head>
	<body class="max-w-7xl mx-auto">
		<div class="relative bg-white" x-data="{ open: false }">
			
			<!-- desktop -->
			<div class="px-4 lg:px-6 bg-gray-100">
				<div class="flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">
					<div class="flex justify-start lg:w-0 flex-1">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="-mr-2 -my-2 lg:hidden">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							
							<!-- Heroicon name: outline/menu -->
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="hidden lg:flex space-x-10">
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a>
						<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>
					</nav>
				</div>
			</div>
			
			<!--Mobile menu, show/hide based on mobile menu state.-->
			<div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">
				<div class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
					<div class="pt-5 pb-6 px-5">
						<div class="flex items-center justify-between">
							<div class="flex">
								<a href="/">
									<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="-mr-2">
								<button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="py-6 px-5 pt-0">
						<nav class=" gap-x-8">
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a>
							<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="background-image: url(&amp;quot;/&amp;quot;);">
			<div class="site-heading">
				<h1 class="text-5xl mb-4 pb-1">
					Using NuGet for Sitecore dev instances (Part&nbsp;1)
				</h1>
			</div>
		</header>
		<div class="py-2 lg:pl-3">
			<div class="lg:flex">
				<div class="lg:flex-auto mx-3 lg:min-w-0 ">
					<p>A couple of weeks ago I had the chance to speak at the Sitecore Technical User Group in Manchester. I gave a talk about experiments into how you can put Sitecore into a NuGet package in order to create low-effort developer instances. Due to time constraints I wasn't able to get all of the information I wanted into the presentation, so over the course of my next three posts I plan to write up the key info from the presentation with that extra detail. 
						<!--more-->
					</p>
					<h2>A little background</h2>
					<p>Some time back there was a bit of debate inside the company I work for about possible better approaches for creating development instances of Sitecore. As we found ourselves working for more clients, and those clients wanted more parallel bits of work, the setup of developer instances of Sitecore was becoming more time consuming. We talked about many of the common approaches to automating this sort of setup, but one of my colleagues suggested the idea packaging Sitecore with NuGet. It seemed like an idea that was worth some investigation to see how it might work in reality.</p>
					<p>
						<a href="/img/2015/2015-04-packagedialog.png" target="_blank">
							<img alt="Package Dialog" src="/img/2015/2015-04-packagedialog.png">
						</a>
					</p>
					<p>Having spent a bit of time investigating how the process might work, it seemed worth sharing our findings – so hence the talk.</p>
					<h2>Useful tools</h2>
					<p>Building NuGet packages isn't hard, and can be done via
						<code>.nuspec</code>
						files and some command line tools if you like. However there are also some helpful Visual Studio extensions such as
						<a href="https://visualstudiogallery.msdn.microsoft.com/fbe9b9b8-34ae-47b5-a751-cb71a16f7e96" target="_blank" rel="noopener noreferrer">NuGet Package Project</a>
						that you can use. If you install this into your copy of Visual Studio you get a new project type for "NuGet Package" and some build automation that transforms the files in your project into a package for you.</p>
					<h2>Overall process</h2>
					<p>Big picture it's pretty simple to put Sitecore into a NuGet package. You have to:</p>
					<ul>
						<li>Get an appropriate version of Sitecore</li>
						<li>Optionally start up Sitecore and do any customisations you want to go into the package – like installing modules for example</li>
						<li>Organise the files into the right structure for a NuGet package</li>
						<li>Modify a few files to make things work correctly</li>
						<li>Build the package</li>
						<li>Publish the package for projects to consume</li>
					</ul>
					<p>But there are a couple of decisions about how you want your package to work that need taking before you start.</p>
					<p>The first is to do with how much of Sitecore you want to end up in the target development project, and hence how much of it you want committed to source control. A simple package could just include all of the files required for Sitecore to run into the "content" of the package so they would be added to the target project. (And hence end up in source control) Whilst this works, I'm not a fan of having any bits of Sitecore that I've not modified as part of my work included in my project. Hence I looked into approaches to try and avoid this situation. The way that seems to have worked best for me is to add the Sitecore files to the package in a way that means they will not be added to the target project file but then use a bit of PowerShell script to ensure that these files are copied to the target project's folder for use at runtime. More detail on this later.</p>
					<p>The second is how you want to deal with accessing the Sitecore databases. The approach that my colleague suggested for this was to make use of LocalDB and its ability to attach databases when they are required by a project. This is quite a simple solution and makes for well isolated development instances – but it may not be suitable for all. Alternatively you can use further PowerShell script to attach the databases to a full instance of SQL Server at the point you install the package.</p>
					<p>The third issue is how you're going to publish your package when you're done with it. As I mentioned in my previous
						<a href="/posts/2014/using-nuget-for-your-references-to-sitecore-dlls" target="_blank">post about NuGet for referencing Sitecore DLLs</a>, you should not publish theses packages publicly for licensing reasons. Hence you should create yourself a private feed to publish to. I've just used a simple "file system share", but you can also install web apps to replicate the full NuGet.org experience if you wish.
						<a href="https://docs.nuget.org/create/hosting-your-own-nuget-feeds" target="_blank" rel="noopener noreferrer">Read more on that subject here</a>.</p>
					<h2>The version of Sitecore</h2>
					<p>The simplest way to grab a version of Sitecore and start working on your package is to download one of the "zip of web folder files" versions of Sitecore. You can just unzip these files and move on with the process.</p>
					<p>But as mentioned above, you might want to have modules or content installed into Sitecore before you package it. In this case it's probably simpler to install a copy of Sitecore via your favoured route, add your content or modules and then move onto the packaging phase with these files and data. You will need to remember to do stuff like detaching databases before moving stuff about for packaging.</p>
					<p>My experiments into this process used Sitecore 6.6 as that's the version I'm using in my day-to-day development. However the same process should generally work with other version. Though V8 will require some extra work to deal with MongoDB.</p>
					<h2>Creating the base package project</h2>
					<p>Use the NuGet Package extension in Visual Studio to create yourself a new package project. The file names aren't important – but they should reflect what it is you're packaging. Remove the readme file that's there by default, and then create the set of folders that we'll sort files into. You need to create:</p>
					<ul>
						<li>A "Content" folder which will hold the files that will be added to the target project</li>
						<li>A "Lib" folder which will hold any binaries that you want to be references of the target project</li>
						<li>A "Tools" folder which will hold the PowerShell scripts for the package install process</li>
						<li>And a "SitecoreFiles" folder which will hold all the files we need for Sitecore to run that we don't want to add into the target project file</li>
					</ul>
					<p>Your solution explorer should end up looking like:</p>
					<p>
						<a href="/img/2015/2015-04-baseproject.png" target="_blank">
							<img alt="Base Project" src="/img/2015/2015-04-baseproject.png">
						</a>
					</p>
					<p>Then you can set the properties on your project. The NuGet Package project properties dialog lets you set the metadata for your package, as well as some settings relating to building it for you. The key ones to look at are:</p>
					<ul>
						<li>Package ID</li>
						<li>Package Version</li>
						<li>Title, Summary, Description</li>
						<li>Icon and URLs</li>
						<li>Generate Symbol Package</li>
						<li>No Package Analysis</li>
					</ul>
					<p>The package ID you choose needs to be suitably descriptive and unique for the work you're doing. I've found the version number needs to reflect both the revision of Sitecore you've packaged and the version of your package definition – in case you need to modify the package to add an extra file for example.</p>
					<p>The titles and summaries etc need to be suitably descriptive so that people looking at your package feed understand what they're downloading. And you can add a package icon URL or links to further information as well if you wish.</p>
					<p>You should turn off both Symbol Package Generation and Package Analysis. You're not building any code in this package, so there's no need to have a separate debug symbols package for it. And if you leave Package Analysis on you'll get a load of warnings later in the process because we're going to include binaries in our project that aren't in the Lib folder.</p>
					<p>As a rough example, your properties might look a bit like this:</p>
					<p>
						<a href="/img/2015/2015-04-packageproperties.png" target="_blank">
							<img alt="Package Properties" src="/img/2015/2015-04-packageproperties.png">
						</a>
					</p>
					<h2>Adding the Sitecore files</h2>
					<p>You now need to add the Sitecore files into the package data. This is easiest to do via Windows Explorer rather than Visual Studio. The steps are as follows:</p>
					<ol>
						<li>Move all the files except the web.config from the Website folder of your Sitecore zip/instance to the "SitecoreFiles" folder of the package</li>
						<li>Create an "App_Data" folder under "SitecoreFiles" and move all the SQL Server database files into it</li>
						<li>Move the Data folder of your Sitecore zip/Instance to the "SitecoreFiles" folder of the package</li>
						<li>If there are any Lucene indexes under the Data\Indexes folder, delete these indexes</li>
						<li>Work out the set of binaries that you want to be references when you install your package into a project. Copy these binaries from the bin folder in your "SitecoreFiles" folder to the "Lib" folder.</li>
						<li>Move the web.config skipped over in #1 into the "Content" folder of your package project.</li>
					</ol>
					<p>Next, you need to organise the rest of the files in the package.<br>
						I'll cover that in my next post.</p>
				</div>
				<div class="lg:flex-none lg:w-72 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
					<section class="mvp">
						<h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2021</h3>
						<div class="bg-white mb-2 p-2">
							<a href="/mvp">
								<img src="/img/mvp/2021.jpg" width="219" height="219" alt="2021 MVP Badge">
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Top Tags</h3>
						<div class="bg-white p-2 flex flex-wrap">
							<a href="/tags/sitecore" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Sitecore (195)</a>
							<a href="/tags/c" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								C# (45)</a>
							<a href="/tags/powershell" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								PowerShell (31)</a>
							<a href="/tags/installation" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Installation (23)</a>
							<a href="/tags/solr" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Solr (15)</a>
							<a href="/tags/ui" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								UI (14)</a>
							<a href="/tags/general" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								General (13)</a>
							<a href="/tags/coveo" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Coveo (12)</a>
							<a href="/tags/docker" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Docker (11)</a>
							<a href="/tags/visual-studio" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Visual Studio (11)</a>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/tags" role="button">All Tags
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Recent Months</h3>
						<div class="bg-white p-2">
							<div>
								<a class="text-lg" href="/posts/2022-01">2022 - January</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2021-12">2021 - December</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2021-11">2021 - November</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2021-10">2021 - October</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2021-09">2021 - September</a>
							</div>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/posts" role="button">All Posts
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Twitter</h3>
						<div class="bg-white mb-2 p-2">
							<a class="twitter-timeline" data-height="400" data-chrome="noheader nofooter noborders" href="https://twitter.com/jermdavis">Tweets by JermDavis</a>
							<script async="" defer="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
						</div>
					</section>
				</div>
			</div>
		</div>
		<footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
			<div class="flex-1 lg:flex-1 text-center lg:text-left">
				<div>©
					<a target="_blank" class="font-medium text-gray-500 hover:text-gray-900" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2022</div>
			</div>
			<div class="lg:flex-1 lg:order-3 text-center lg:text-right">
				<a class="font-medium text-gray-500 hover:text-gray-900" href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
				<li class="inline-block">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
				<div class="w-full text-lg">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, (7*24*60*60));" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.7.1.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
        EnlighterJS.init('pre', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
    
		</script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>