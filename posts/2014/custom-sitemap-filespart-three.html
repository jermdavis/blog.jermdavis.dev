<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' *.twitter.com unpkg.com www.googletagmanager.com www.google-analytics.com *.twimg.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline' *.twitter.com *.twimg.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
        <link rel="canonical" href="https://blog.jermdavis.dev/posts/2014/custom-sitemap-filespart-three">
        <meta name="description" content="The third part of this series is to look at how we can add images to our XML Sitemap files. We&amp;#x27;ve looked at &amp;lt;a href=&amp;quot;/posts/2014/custom-sitemap-filespart-one&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;the configuration&amp;lt;/a&amp;gt; and &amp;lt;a href=&amp;quot;/posts/2014/custom-sitemap-filespart-two&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;the basic code&amp;lt;/a&amp;gt; to get entries into Sitemap files in the first two posts.&amp;#xA;Getting images into the sitemap requires two things: First specifying some rules for what images to include, and secondly some code to extract those images from the content and write them into the index files. The code to deal with images that are specified in fields on the web page item is easy &amp;#x2013; but we also need to deal with the situation where the image is referred to by a component that has been dynamically bound to the page. ">
        <meta property="og:description" content="The third part of this series is to look at how we can add images to our XML Sitemap files. We&amp;#x27;ve looked at &amp;lt;a href=&amp;quot;/posts/2014/custom-sitemap-filespart-one&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;the configuration&amp;lt;/a&amp;gt; and &amp;lt;a href=&amp;quot;/posts/2014/custom-sitemap-filespart-two&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;the basic code&amp;lt;/a&amp;gt; to get entries into Sitemap files in the first two posts.&amp;#xA;Getting images into the sitemap requires two things: First specifying some rules for what images to include, and secondly some code to extract those images from the content and write them into the index files. The code to deal with images that are specified in fields on the web page item is easy &amp;#x2013; but we also need to deal with the situation where the image is referred to by a component that has been dynamically bound to the page. ">
            <meta name="keywords" content="C#, Sitecore">
        <meta name="author" content="Jeremy Davis">
        <meta name="copyright" content="Jeremy Davis">

    <title>Jeremy Davis - Custom Sitemap Files &#x2013; Part Three</title> 

        <meta name="robots" content="index, follow">

            <link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
            <link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">

    <meta name="application-name" content="Jeremy Davis">
    <meta name="msapplication-tooltip" content="Jeremy Davis">
    <meta name="msapplication-starturl" content="/">
    <link rel="manifest" href="/manifest.webmanifest">

    
    <meta property="og:title" content="Jeremy Davis - Custom Sitemap Files &amp;#x2013; Part Three">
        <meta property="og:image" content="https://blog.jermdavis.dev/img/featured/custom-sitemap-filespart-three-social.jpg">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Custom Sitemap Files &#x2013; Part Three",
        "image": [
            "https://blog.jermdavis.dev/img/featured/custom-sitemap-filespart-three-social.jpg"
        ],
        "datePublished": "2014-05-20T00:00:00+00:00",
        "dateModified": "2016-08-25T00:00:00+00:00",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    </script>
<meta property="og:url" content="https://blog.jermdavis.dev/posts/2014/custom-sitemap-filespart-three">
<meta property="og:type" content="website">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

    <link href="/scss/tailwind.css" rel="stylesheet">

    <link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
    <link href="/scss/site-theme.css" rel="stylesheet">


    <script src="/vendor/Cookies/cookies.min.js" defer=""></script>

    

    
    <!-- 07/07/2022 20:20:55 -->
</head>

<body class="max-w-7xl mx-auto">
    <div class="relative bg-white" x-data="{ open: false }">

    <!-- desktop -->
    <div class="px-4 lg:px-6 bg-gray-100">
        <div class="flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">

            <div class="flex justify-start lg:w-0 flex-1">
                <a href="/">
                    <img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
                </a>
                <div class="mx-2">
                    <div class="text-3xl">Jeremy Davis</div>
                    <div class="text-lg">Sitecore, C# and web development</div>
                </div>
            </div>

            <div class="nav -mr-2 -my-2 lg:hidden">
                <button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
                    <span class="sr-only">Open menu</span>
                    <!-- Heroicon name: outline/menu -->
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>

            <nav class="nav hidden lg:flex space-x-10">
<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a><a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>            </nav>

        </div>
    </div>

    <!--Mobile menu, show/hide based on mobile menu state.-->
    <div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">

        <div class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
            <div class="pt-5 pb-6 px-5">
                <div class="flex items-center justify-between">
                    <div class="flex">
                        <a href="/">
                            <img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
                        </a>
                        <div class="mx-2">
                            <div class="text-2xl">Jeremy Davis</div>
                            <div class="text-base">Sitecore, C# and web development</div>
                        </div>
                    </div>

                    <div class="nav -mr-2">
                        <button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                            <span class="sr-only">Close menu</span>
                            <!-- Heroicon name: outline/x -->
                            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="nav py-6 px-5 pt-0">
                <nav class=" gap-x-8">
<a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/posts">Posts</a><a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/tags">Tags</a><a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/about">About</a><a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/links">Useful Links</a><a class="block mt-5 text-base font-medium text-gray-500 hover:text-gray-900" href="/mvp">MVP</a>                </nav>
            </div>

        </div>
    </div>
</div>

    <header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="background-image: url(&amp;quot;/&amp;quot;);">
    <div class="post-heading">
        <h1 class="text-5xl mb-4 pb-1">
        Custom Sitemap Files – Part Three
        </h1>
            <div class="meta">Published 20 May 2014</div>
                <div class="meta">Updated 25 August 2016</div>
            <div class="flex py-1">
                    <a href="/tags/c/" class="p-1 mr-1 bg-gray-100 rounded-md"> C#</a>
                    <a href="/tags/sitecore/" class="p-1 mr-1 bg-gray-100 rounded-md"> Sitecore</a>
            </div>
    </div>
</header>

    <div class="py-2 lg:pl-3">
        <div class="lg:flex">
            <div class="lg:flex-auto mx-3 lg:min-w-0 content">
                <p>The third part of this series is to look at how we can add images to our XML Sitemap files. We've looked at <a href="/posts/2014/custom-sitemap-filespart-one" target="_blank">the configuration</a> and <a href="/posts/2014/custom-sitemap-filespart-two" target="_blank">the basic code</a> to get entries into Sitemap files in the first two posts.</p>
<p>Getting images into the sitemap requires two things: First specifying some rules for what images to include, and secondly some code to extract those images from the content and write them into the index files. The code to deal with images that are specified in fields on the web page item is easy – but we also need to deal with the situation where the image is referred to by a component that has been dynamically bound to the page. <!--more--></p>
<p>The configuration for an &quot;image field on the current page&quot; reference is pretty easy:</p>
<a target="_blank" rel="noopener noreferrer" href="/img/2014/SitemapFieldImageTemplate.png">
<img alt="Image field template" src="/img/2014/SitemapFieldImageTemplate.png">
</a>
<p>We declare a new template for the configuration of these images. Each instance of this will specify the name of a Sitecore Image field that we'll try to load the image from. And we configure the Sitemap File template to allow image configuration to be added as children. We can then add instances of this template to our test config:</p>
<a target="_blank" rel="noopener noreferrer" href="/img/2014/ImageFileSettings.png">
<img alt="Image field settings" src="/img/2014/ImageFileSettings.png">
</a>
<p>Now, for images that are in the data sources of components on our page we need a little more data:</p>
<a href="/img/2014/2014-05-untitled1.png" target="_blank">
<img alt="Untitled1" src="/img/2014/2014-05-untitled1.png">
</a>
<p>This template will be used in the same way (to create items that are children of our sitemap config) but here we let the user choose a component type to look for as well as the name of the field to find in its data source. And we can set that up as so:</p>
<a href="/img/2014/2014-05-untitled2.png" target="_blank">
<img alt="Untitled 2" src="/img/2014/2014-05-untitled2.png">
</a>
<p>With that configuration in place, (and some extra test data) we now need some code to process it. And that splits into three pieces. Additions to the configuration classes we defined to represent the config items. New code to extract the image data. And finally the extra code to serialise the data.</p>
<p>The class to extract the image configuration into is fairly simple:</p>
<pre><code class="language-csharp">public class ImageConfiguration
{
    public bool IsFieldImage { get; private set; }
    public string ImageFieldName { get; private set; }
    public string ImageComponent { get; private set; }

    public ImageConfiguration(SiteConfiguration sc, Item img)
    {
        if (img.TemplateID == Identifiers.SitemapComponentImageTemplateID)
        {
            IsFieldImage = false;

            ImageFieldName = img.Fields[Identifiers.SitemapImageFieldName_ComponentBasedFieldID].Value;

            string cmpID = img.Fields[Identifiers.SitemapImageComponentFieldID].Value;
            if (!string.IsNullOrWhiteSpace(cmpID))
            {
                ImageComponent = cmpID.ToUpperInvariant();
            }
        }
        if (img.TemplateID == Identifiers.SitemapFieldImageTemplateID)
        {
            IsFieldImage = true;

            ImageFieldName = img.Fields[Identifiers.SitemapImageFieldName_FieldBasedFieldID].Value;
        }
    }
}
</code></pre>
<p>And we can extend the configuration class for each sitemap to include a set of these images:</p>
<pre><code class="language-csharp">public class SiteConfiguration
{
    public string SitemapFilename { get; private set; }
    public string SitemapSourceDatabaseName { get; private set; }
    public Database SitemapSourceDatabase { get; private set; }
    public ID SitemapRootItem { get; private set; }
    public IEnumerable SitemapIncludeLanguages { get; private set; }
    public IEnumerable SitemapIncludeTemplates { get; private set; }
    public IEnumerable ImageExtraction { get; private set; }

    private Language getLanguage(string name)
    {
        Language l;

        if (Language.TryParse(name, out l))
        {
            return l;
        }

        return null;
    }

    public SiteConfiguration(Item siteItem)
    {
        SitemapFilename = siteItem.Fields[Identifiers.SitemapFilenameFieldID].Value;

        SitemapSourceDatabaseName = siteItem.Fields[Identifiers.SitemapSourceDatabaseFieldID].Value;

        SitemapSourceDatabase = Sitecore.Configuration.Factory.GetDatabase(SitemapSourceDatabaseName);

        ID rootItem = ID.Null;
        ID.TryParse(siteItem.Fields[Identifiers.SitemapRootItemFieldID].Value, out rootItem);
        SitemapRootItem = rootItem;

        SitemapIncludeLanguages = siteItem.Fields[Identifiers.SitemapIncludeLanguagesFieldID].Value.Split('|')
            .Where(s =&gt; !string.IsNullOrWhiteSpace(s))
            .Select(s =&gt; ID.Parse(s))
            .Select(i =&gt; SitemapSourceDatabase.GetItem(i))
            .Select(l =&gt; l.Name);

        SitemapIncludeTemplates = siteItem.Fields[Identifiers.SitemapIncludeTemplatesFieldID].Value.Split('|')
            .Where(s =&gt; !string.IsNullOrWhiteSpace(s))
            .Select(s =&gt; ID.Parse(s));

        var imageExtraction = siteItem.Axes.SelectItems(string.Format(&quot;./*[&#64;&#64;templateid='{0}' or &#64;&#64;templateid='{1}']&quot;, Identifiers.SitemapFieldImageTemplateID, Identifiers.SitemapComponentImageTemplateID));
        if (imageExtraction != null &amp;&amp; imageExtraction.Length &gt; 0)
        {
            ImageExtraction = imageExtraction
                .Select(i =&gt; new ImageConfiguration(this, i));
        }
        else
        {
            ImageExtraction = new List();
        }
    }
}
</code></pre>
<p>And we can extend the classes we use to store our sitemap data before we serialise it too – by adding a class to store and serialise image data:</p>
<pre><code class="language-csharp">public class SitemapUrl
{
    private List _images = new List();

    public IEnumerable Images { get { return _images; } }

    public void Add(SitemapImage img)
    {
        _images.Add(img);
    }

    public void AddRange(IEnumerable imgs)
    {
        _images.AddRange(imgs);
    }

    public string Location { get; set; }
    public DateTime? LastModified { get; set; }
    public ChangeFrequency? ChangeFrequency { get; set; }
    public Single? Priority { get; set; }

    public XElement Serialise()
    {
        XElement root = new XElement(&quot;url&quot;);

        root.Add(new XElement(&quot;loc&quot;, Location));
        
        foreach(SitemapImage img in _images)
        {
            root.Add(img.Serialise());
        }

        if(LastModified.HasValue)
        {
            root.Add(new XElement(&quot;lastmod&quot;, LastModified.Value.ToString(&quot;yyyy-MM-dd&quot;)));
        }

        if (ChangeFrequency.HasValue)
        {
            root.Add(new XElement(&quot;changefreq&quot;, ChangeFrequency.Value.ToString().ToLower()));
        }

        if (Priority.HasValue)
        {
            root.Add(new XElement(&quot;priority&quot;, Priority.Value.ToString(&quot;0.0&quot;)));
        }

        return root;
    }
}

public class SitemapImage
{
    public string Location { get; set; }
    public string Caption {get;set;}
    public string GeoLocation {get;set;}
    public string Title {get;set;}
    public string License {get;set;}

    public static readonly XNamespace Namespace = &quot;http://www.google.com/schemas/sitemap-image/1.1&quot;;

    public XElement Serialise()
    {
        XElement img = new XElement(Namespace + &quot;image&quot;);

        img.Add(new XElement(Namespace + &quot;loc&quot;, Location));

        if (!string.IsNullOrWhiteSpace(Caption))
        {
            img.Add(new XElement(Namespace + &quot;caption&quot;, Caption));
        }

        if(!string.IsNullOrWhiteSpace(GeoLocation))
        {
            img.Add(new XElement(Namespace + &quot;geo_location&quot;, GeoLocation));
        }

        if(!string.IsNullOrWhiteSpace(Title))
        {
            img.Add(new XElement(Namespace + &quot;title&quot;, Title));
        }

        if(!string.IsNullOrWhiteSpace(License))
        {
            img.Add(new XElement(Namespace + &quot;license&quot;, License));
        }

        return img;
    }
}
</code></pre>
<p>And with all that in place, we can start updating the  code to generate the data. According to <a href="https://support.google.com/webmasters/answer/178636?hl=en" target="_blank" rel="noopener noreferrer">the schema definition for Sitemap XML</a>, the image data goes into the url element, so we can add the code to the place in last week's code where we were generating that bit of data – the <code>processLanguage()</code> method. All we change here is to add a call to a new <code>processImages()</code> method and add the results to the images collection in the <code>SitemapUrl</code> object:</p>
<pre><code class="language-csharp">private SitemapUrl processLanguage(SiteConfiguration sc, Item item, Language l)
{
    SitemapUrl url = new SitemapUrl();

    var uo = new Sitecore.Links.UrlOptions()
    {
        AlwaysIncludeServerUrl = true,
        LanguageEmbedding = Sitecore.Links.LanguageEmbedding.AsNeeded,
        ShortenUrls = true,
        Language = l
    };

    url.Location = Sitecore.Links.LinkManager.GetItemUrl(item, uo);

    // process images
    url.AddRange(processImages(sc, item, l));

    DateField df = (DateField)item.Fields[Identifiers.__UpdatedFieldID];
    url.LastModified = df.DateTime;

    if (item.Fields.Contains(Identifiers.SitemapPriorityFieldID))
    {
        float f;
        if (float.TryParse(item.Fields[Identifiers.SitemapPriorityFieldID].Value, out f))
        {
            url.Priority = f;
        }
    }

    if (item.Fields.Contains(Identifiers.SitemapChangeFrequencyFieldID))
    {
        ChangeFrequency cf;
        if (Enum.TryParse(item.Fields[Identifiers.SitemapChangeFrequencyFieldID].Value, true, out cf))
        {
            url.ChangeFrequency = cf;
        }
    }

    return url;
}
</code></pre>
<p>The new method needs to process all the config we've set up for images, and generate the relevant data:</p>
<pre><code class="language-csharp">private IEnumerable&lt;SitemapImage&gt; processImages(SiteConfiguration sc, Item item, Language l)
{
    List&lt;SitemapImage&gt; imgs = new List&lt;SitemapImage&gt;();

    foreach (ImageConfiguration icfg in sc.ImageExtraction)
    {
        if (icfg.IsFieldImage)
        {
            SitemapImage img = makeImg(icfg, item);
            if (img != null)
            {
                imgs.Add(img);
            }
        }
        else
        {
            string xml = LayoutField.GetFieldValue(item.Fields[&quot;__Renderings&quot;]);
            LayoutDefinition ld = LayoutDefinition.Parse(xml);

            DeviceDefinition deviceDef = ld.GetDevice(&quot;{FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3}&quot;);

            foreach(RenderingDefinition renderingDef in deviceDef.GetRenderings(icfg.ImageComponent))
            {
                Item itm = sc.SitemapSourceDatabase.GetItem(renderingDef.Datasource);
                if (itm != null)
                {
                    SitemapImage img = makeImg(icfg, itm);
                    if (img != null)
                    {
                        imgs.Add(img);
                    }
                }
            }                    
        }
    }

    return imgs;
}
</code></pre>
<p>So, if the image configuration says &quot;get the image from a field on the current item&quot; then we just read the value from that field. But for the &quot;get the image from a component data source&quot; config we need to do a bit more work.</p>
<p>Sitecore stores its information about page layouts inside the &quot;__Renderings&quot; field on an item. This contains some XML that describes what's called a Layout Delta. (<a href="http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2012/12/Sitecore-Idiosyncrasies-Layout-Details-and-Layout-Deltas.aspx" target="_blank" rel="noopener noreferrer">All that is explained here</a>) In order to extract the data about &quot;what components are on this page&quot; we parse ask a couple of helper classes to fetch the layout XML for us and then parse it into Sitecore's object model for this data. Then we need to specify what device we're using. Here I've hard coded it to use the &quot;Default&quot; device's ID. In reality you'd probably want that to be configurable in some way. Once we have a device, we can call <code>GetRenderings()</code> on that device to get back a list of any components being displayed that make use of the UI component defined by the ID we pass in - and that ID comes from our configuration item. (Back in the config above, we picked the component with a Droptree – so the value we have here is a GUID) We then iterate the set of <code>RenderingDefinition</code> objects we get back, and try to add an image item for each one.</p>
<p>Generating the sitemap data for the image happens in the <code>makeImg()</code> method:</p>
<pre><code class="language-csharp">private SitemapImage makeImg(ImageConfiguration icfg, Item item)
{
    var mo = new Sitecore.Resources.Media.MediaUrlOptions()
    {
        AlwaysIncludeServerUrl = true,
        AbsolutePath = true
    };

    ImageField img = (ImageField)item.Fields[icfg.ImageFieldName];
    if (img != null &amp;&amp; !string.IsNullOrWhiteSpace(img.Value))
    {
        var si = new SitemapImage();
        si.Location = Sitecore.Resources.Media.MediaManager.GetMediaUrl(img.MediaItem, mo);
            
        string caption = img.MediaItem.Fields[Identifiers.DescriptionFieldID].Value;
        if (!string.IsNullOrWhiteSpace(caption))
        {
            si.Caption = caption;
        }

        string title = img.MediaItem.Fields[Identifiers.TitleFieldID].Value;
        if (!string.IsNullOrWhiteSpace(title))
        {
            si.Title = title;
        }

        return si;
    }

    return null;
}
</code></pre>
<p>That uses the MediaManager to generate the URL for the image, extracts a few properties and returns our data item for serialising.</p>
<p>So when we wire all that up, and re-generate our sitemap XML we get:</p>
<pre><code class="language-xml">&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot; xmlns:image=&quot;http://www.google.com/schemas/sitemap-image/1.1&quot;&gt;
  &lt;url&gt;
    &lt;loc&gt;http://test/en/sitecore/content/Home&lt;/loc&gt;
    &lt;image:image&gt;
      &lt;image:loc&gt;http://test/~/media/System/Simulator Backgrounds/Android Phone.ashx&lt;/image:loc&gt;
    &lt;/image:image&gt;
    &lt;image:image&gt;
      &lt;image:loc&gt;http://test/~/media/System/Simulator Backgrounds/Blackberry.ashx&lt;/image:loc&gt;
    &lt;/image:image&gt;
    &lt;lastmod&gt;2014-10-05&lt;/lastmod&gt;
    &lt;changefreq&gt;daily&lt;/changefreq&gt;
    &lt;priority&gt;0.7&lt;/priority&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://test/ja-JP/sitecore/content/Home&lt;/loc&gt;
    &lt;image:image&gt;
      &lt;image:loc&gt;http://test/~/media/System/Simulator Backgrounds/Blackberry.ashx&lt;/image:loc&gt;
    &lt;/image:image&gt;
    &lt;lastmod&gt;2013-09-11&lt;/lastmod&gt;
    &lt;changefreq&gt;daily&lt;/changefreq&gt;
    &lt;priority&gt;0.7&lt;/priority&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://test/en/sitecore/content/Home/Global shared content/Sample&lt;/loc&gt;
    &lt;lastmod&gt;2014-29-21&lt;/lastmod&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://test/en/sitecore/content/Home/Sample Page&lt;/loc&gt;
    &lt;image:image&gt;
      &lt;image:loc&gt;http://test/~/media/Images/HTC_000004.ashx&lt;/image:loc&gt;
      &lt;image:caption&gt;A quick snapshot&lt;/image:caption&gt;
      &lt;image:title&gt;A view across some countryside&lt;/image:title&gt;
    &lt;/image:image&gt;
    &lt;lastmod&gt;2014-12-03&lt;/lastmod&gt;
  &lt;/url&gt;
&lt;/urlset&gt;
</code></pre>
<p>And there we have it. Configurable sitemaps that can include image data as well as the more usual stuff.</p>
<p>If you're interested in playing with this yourself you can <a href="/files/Sitemaps-Package.zip" target="_blank" rel="noopener noreferrer">download a package file of the sitecore templates and example config</a> and a <a href="/files/Sitemaps-source.zip" target="_blank" rel="noopener noreferrer">zip file of the example c# files</a> to put together yourself and play with. But please remember that this is just proof of concept code so it's not sensible to use it in production as-is.</p>
<p>I think I've got one more post to make on this topic – next will be some thoughts on how you can address sitemap generation on very large sites, where performance can be an issue.</p>


            </div>
            <div class="sidebar lg:flex-none lg:w-72 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
                <section class="mvp">
    <h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2022</h3>
    <div class="bg-white mb-2 p-2"><a href="/mvp"><img src="/img/mvp/2022.jpg" width="219" height="219" alt="2022 MVP Badge"></a></div>
</section>

<section>
    <h3 class="bg-gray-300 p-2">Top Tags</h3>
    <div class="bg-white p-2 flex flex-wrap">
                    <a href="/tags/sitecore/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Sitecore (202)</a>
                    <a href="/tags/c/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> C# (47)</a>
                    <a href="/tags/powershell/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> PowerShell (31)</a>
                    <a href="/tags/installation/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Installation (23)</a>
                    <a href="/tags/solr/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Solr (15)</a>
                    <a href="/tags/general/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> General (14)</a>
                    <a href="/tags/ui/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> UI (14)</a>
                    <a href="/tags/docker/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Docker (12)</a>
                    <a href="/tags/coveo/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Coveo (12)</a>
                    <a href="/tags/packages/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1"> Packages (11)</a>
    </div>
    <div class="bg-white mb-2 p-2">
        <a class="" href="/tags" role="button">All Tags <i class="fas fa-angle-double-right"></i></a>
    </div>
</section>

<section>
    <h3 class="bg-gray-300 p-2">Recent Months</h3>
    <div class="bg-white p-2">
                <div><a class="text-lg" href="/posts/2022-07">2022 - July</a></div>
                <div><a class="text-lg" href="/posts/2022-06">2022 - June</a></div>
                <div><a class="text-lg" href="/posts/2022-05">2022 - May</a></div>
                <div><a class="text-lg" href="/posts/2022-04">2022 - April</a></div>
                <div><a class="text-lg" href="/posts/2022-03">2022 - March</a></div>
    </div>
    <div class="bg-white mb-2 p-2">
        <a class="" href="/posts" role="button">All Posts <i class="fas fa-angle-double-right"></i></a>
    </div>
</section>

<section>
    <h3 class="bg-gray-300 p-2">Twitter</h3>
    <div class="bg-white mb-2 p-2">
        <a class="twitter-timeline" data-height="400" data-chrome="noheader nofooter noborders" href="https://twitter.com/jermdavis">Tweets by JermDavis</a>
        <script async="" defer="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>
</section>
            </div>
        </div>
    </div>

    <footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
    <div class="flex-1 lg:flex-1 text-center lg:text-left">
        <div>&copy; <a target="_blank" class="font-medium text-gray-500 hover:text-gray-900" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a> 2014-2022</div>
    </div>

    <div class="lg:flex-1 lg:order-3 text-center lg:text-right">
        <a class="font-medium text-gray-500 hover:text-gray-900" href="/tools">Published using Statiq</a><br>
    </div>

    <ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
        <li class="inline-block">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
            </svg>
        </li>
            <li class="inline-block ml-4">
                <a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.rss">RSS</a>
            </li>
            <li class="inline-block ml-4">
                <a class="font-medium text-gray-500 hover:text-gray-900" target="_blank" href="/feed.atom">Atom</a>
            </li>
    </ul>
</footer>

    <div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
        <div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
            <div class="w-full text-lg">
                <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
            </div>
            <button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
        </div>
    </div>
    
    <script src="/vendor/Alpine/alpine.3.7.1.min.js" defer=""></script>
    <script src="/vendor/Enlighter/enlighterjs.min.js"></script>

    <script type="text/javascript">
        EnlighterJS.init('pre', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
    </script>

    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    </script>

    

    



</body></html>