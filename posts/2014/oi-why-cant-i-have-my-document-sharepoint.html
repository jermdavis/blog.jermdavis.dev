<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' www.youtube.com *.twitter.com unpkg.com www.googletagmanager.com *.google-analytics.com *.twimg.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline' *.twitter.com *.twimg.com">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">
		<meta name="description" content="Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my &quot;Local Intranet&quot; sites in Internet Explorer.
Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:">
		<meta property="og:description" content="Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my &quot;Local Intranet&quot; sites in Internet Explorer.
Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:">
		<meta name="keywords" content="SharePoint">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Oi! Why can't I have my document,&nbsp;SharePoint?</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta property="og:title" content="Jeremy Davis - Oi! Why can&amp;#x27;t I have my document,&amp;#xA0;SharePoint?">
		<meta property="og:publish_date" content="2014-11-24T00:00:00+00:00">
		<meta property="og:type" content="article">
		<meta property="og:modified_date" content="2018-09-27T00:00:00+00:00">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/oi-why-cant-i-have-my-document-sharepoint-social.jpg">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Oi! Why can&#x27;t I have my document,&#xA0;SharePoint?",
        "url": "https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint",
        "image": [
            "https://blog.jermdavis.dev/img/featured/oi-why-cant-i-have-my-document-sharepoint-social.jpg"
        ],
        "datePublished": "2014-11-24T00:00:00+00:00",
        "dateModified": "2018-09-27T00:00:00+00:00",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/scss/tailwind.css" rel="stylesheet">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/scss/site-theme.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="max-w-7xl mx-auto text-black">
		<div class="relative bg-white" x-data="{ open: false }">
			
			<!-- desktop -->
			<div class="px-4 lg:px-6 bg-gray-100">
				<div class="bannerContainer flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">
					<div class="flex justify-start lg:w-0 flex-1">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav -mr-2 -my-2 lg:hidden">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							
							<!-- Heroicon name: outline/menu -->
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav hidden lg:flex space-x-10">
						<a class="text-base font-medium" href="/posts">Posts</a>
						<a class="text-base font-medium" href="/tags">Tags</a>
						<a class="text-base font-medium" href="/about">About</a>
						<a class="text-base font-medium" href="/links">Useful Links</a>
						<a class="text-base font-medium" href="/mvp">MVP</a>
					</nav>
				</div>
			</div>
			
			<!--Mobile menu, show/hide based on mobile menu state.-->
			<div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">
				<div class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
					<div class="pt-5 pb-6 px-5">
						<div class="flex items-center justify-between">
							<div class="flex">
								<a href="/">
									<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav -mr-2">
								<button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav py-6 px-5 pt-0">
						<nav class=" gap-x-8">
							<a class="block mt-5 text-base font-medium" href="/posts">Posts</a>
							<a class="block mt-5 text-base font-medium" href="/tags">Tags</a>
							<a class="block mt-5 text-base font-medium" href="/about">About</a>
							<a class="block mt-5 text-base font-medium" href="/links">Useful Links</a>
							<a class="block mt-5 text-base font-medium" href="/mvp">MVP</a>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="">
			<div class="post-heading">
				<div class="url p-1 bg-gray-100 rounded-md">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2014/oi-why-cant-i-have-my-document-sharepoint</tt>
				</div>
				<h1 class="text-5xl mb-4 pb-1">
					Oi! Why can't I have my document,&nbsp;SharePoint?
				</h1>
				<div class="meta">Published 24 November 2014</div>
				<div class="meta">Updated 27 September 2018</div>
				<div class="flex py-1">
					<a href="/tags/sharepoint/" class="p-1 mr-1 bg-gray-100 rounded-md">
						SharePoint</a>
				</div>
			</div>
		</header>
		<div class="py-2 lg:pl-3">
			<div class="lg:flex">
				<div class="lg:flex-auto mx-3 lg:min-w-0 content">
					<p>Not a Sitecore issue this week – but an issue I've been suffering from whilst working on Sitecore projects none the less. Like many IT companies working in the Microsoft space, we have a SharePoint site where our project documents live. Quite regularly, when I try to open one of those documents I get a login popup. Despite the fact that SharePoint is in my "Local Intranet" sites in Internet Explorer.</p>
					<p>Recently this managed to annoy me enough that I took the time to investigate and fix the issue. Here's what I found:
						<!--more-->
					</p>
					<p>It doesn't really make sense at first: I click a document in SharePoint and get this:</p>
					<p>
						<a href="/img/2014/2014-11-doclist1.png" target="_blank">
							<img alt="Doc List" src="/img/2014/2014-11-doclist1.png">
						</a>
					</p>
					<p>I know I'm logged in to the network, I know that the DNS name for the SharePoint site is in my IE "Local Intranet" sites and I know that "automatic logon" is allowed for those sites. So why the login dialog?</p>
					<p>After a bit of rooting around the Internet, and the usual game of "what are the correct Google keywords for my problem" I came across a Microsoft Knowledge Base article:
						<a target="_blank" rel="noopener noreferrer" href="http://support.microsoft.com/kb/943280">KB943280</a>
						"Prompt for Credentials When Accessing FQDN Sites From a Windows Vista or Windows 7 Computer". Whilst this dates from 2011, this has allowed me to work out the issue.</p>
					<p>It turns out to be down to how Windows accesses
						<a href="http://en.wikipedia.org/wiki/WebDAV" target="_blank" rel="noopener noreferrer">WebDAV</a>
						shares. The Windows components that are used to access WebDAV are not the same ones that IE uses to deal with ordinary HTTP requests. So while you may be using IE (and its security settings) to access the SharePoint site, the attempt to load the document from SharePoint itself uses the "Windows HTTP Services" components by default – and crucially these never look at the IE Security settings.</p>
					<p>These alternative components are configured to only ever send username and password information to sites that appear to be local. And it decides what "local" is based on the URL. If it's just a server name, i.e.:
						<code>http://MyServer/document.docx</code>
						then that's local. If it's a fully qualified DNS name, i.e.
						<code>http://myserver.mycompany.com/document.docx</code>
						then that's remote and security data will not be sent automatically.</p>
					<p>And that's the root of the issue – I'm a full-time remote worker. Hence I am accessing SharePoint via a fully qualified DNS name since NetBIOS / WINS names don't work for me on the end of a VPN tunnel.</p>
					<p>So how do I fix this?</p>
					<p>I suppose I could just create a
						<a href="https://en.wikipedia.org/wiki/Hosts_%28file%29" target="_blank" rel="noopener noreferrer">HOSTS</a>
						file entry for the NetBIOS name of the SharePoint server. But that seems a bit inelegant. Load balancing, virtual machines or just a plain old migration to a new version make it seem more likely that eventually the IP address would change and I'd be confused for a while about why SharePoint appeared broken. Rather than hiding the symptom, I need to fix the underlying issue.</p>
					<p>Reading through the Knowledge Base article above, it talks about two things. Firstly, a patch to change the behaviour of the Windows HTTP Services components to allow configuration to override this setting. And secondly it talks about the registry settings you can use.</p>
					<p>Since the article was last revised years ago, I tried a quick test to see if the code in the hotfix was already present in my (well patched) install of Windows 7. Turns out that it is – so chances are you can skip the patching bit of the KB article if you're running a recent release of Windows. I'm not sure about Windows 8, as I don't have a machine to try it on, however.</p>
					<p>The article talks about adding a single registry setting. Under
						<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters</code>
						cretae a new "Multi-String value" entry called
						<code>AuthForwardServerList</code>. Modify its value, and enter DNS names for the server(s) you want to be treated as Local Intranet sites for the purposes of WebDAV.</p>
					<p>You can use wildcards, protocols etc if you want, but make sure you think about the security implications of your settings. For example having
						<code>http://myserver.*</code>
						is a security risk, as this means WebDAV requests to a server named
						<code>myserver.nastyhacker.com</code>
						would get authentication data sent automatically. There is more detail about the security implications in the article, so if you're not sure read the details.</p>
					<p>Having added the setting:</p>
					<p>
						<a href="/img/2014/2014-11-setting.png" target="_blank">
							<img alt="Setting" src="/img/2014/2014-11-setting.png">
						</a>
					</p>
					<p>And then restarted the
						<code>WebClient</code>
						service:</p>
					<p>
						<a href="/img/2014/2014-11-restartservice.png" target="_blank">
							<img alt="Restart Service" src="/img/2014/2014-11-restartservice.png">
						</a>
					</p>
					<p>I can now click files in SharePoint and not have to enter my credentials. Success.</p>
				</div>
				<div class="sidebar lg:flex-none lg:w-64 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
					<section class="mvp">
						<h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2023</h3>
						<div class="bg-white mb-2 p-2">
							<a href="/mvp">
								<img class="lg:mx-auto" src="/img/mvp/2023.png" width="219" height="219" alt="2023 MVP Badge">
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Top Tags</h3>
						<div class="bg-white p-2 flex flex-wrap">
							<a href="/tags/sitecore/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Sitecore (217)</a>
							<a href="/tags/c/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								C# (53)</a>
							<a href="/tags/powershell/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								PowerShell (31)</a>
							<a href="/tags/installation/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Installation (23)</a>
							<a href="/tags/solr/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Solr (19)</a>
							<a href="/tags/general/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								General (16)</a>
							<a href="/tags/docker/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Docker (16)</a>
							<a href="/tags/ui/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								UI (15)</a>
							<a href="/tags/containers/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Containers (13)</a>
							<a href="/tags/bug/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
								Bug (12)</a>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/tags" role="button">All Tags
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Recent Months</h3>
						<div class="bg-white p-2">
							<div>
								<a class="text-lg" href="/posts/2023-07">2023 - July</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-06">2023 - June</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-05">2023 - May</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-04">2023 - April</a>
							</div>
							<div>
								<a class="text-lg" href="/posts/2023-03">2023 - March</a>
							</div>
						</div>
						<div class="bg-white mb-2 p-2">
							<a class="" href="/posts" role="button">All Posts
								<i class="fas fa-angle-double-right"></i>
							</a>
						</div>
					</section>
					<section>
						<h3 class="bg-gray-300 p-2">Socials</h3>
						<div class="bg-white mb-2 p-2">
							<div>
								<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">Mastodon</a>
							</div>
							<div>
								<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">LinkedIn</a>
							</div>
							<div>
								<a rel="me" target="_blank" href="https://twitter.com/jermdavis">Twitter</a>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
		<footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
			<div class="flex-1 lg:flex-1 text-center lg:text-left">
				<div>©
					<a target="_blank" class="font-medium" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2023</div>
			</div>
			<div class="lg:flex-1 lg:order-3 text-center lg:text-right">
				<a class="font-medium" href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
				<li class="inline-block">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
				<div class="w-full text-lg">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.7.1.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>