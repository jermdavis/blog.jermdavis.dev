<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="/js/theme.js"></script>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' unpkg.com www.googletagmanager.com *.google-analytics.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline'; frame-src https://www.youtube.com/">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">
		<meta name="description" content="Upgrading the version of Statiq used by my blog caused an issue with Xrefs. Here's how I diagnosed and fixed it.">
		<meta property="og:description" content="Upgrading the version of Statiq used by my blog caused an issue with Xrefs. Here's how I diagnosed and fixed it.">
		<meta name="keywords" content="Statiq, General">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Xref links in recent Statiq versions</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta name="fediverse:creator" content="@jermdavis@mastodon.social">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Xref links in recent Statiq versions [by Jeremy Davis]">
		<meta property="og:publish_date" content="2022-05-23T00:00:00+0000">
		<meta property="article:published_time" content="2022-05-23T00:00:00+0000">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/xref-recent-statiq-social.jpg">
		<meta property="og:image:alt" content="Logo image showing post title 'Xref links in recent Statiq versions' and author 'Jeremy Davis'">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Xref links in recent Statiq versions",
        "url": "https://blog.jermdavis.dev/posts/2022/xref-recent-statiq",
        "image": [
            {
                "@type": "ImageObject",
                "contentUrl": "https://blog.jermdavis.dev/img/featured/xref-recent-statiq-social.jpg",
                "caption": "Logo image showing post title 'Xref links in recent Statiq versions' and author 'Jeremy Davis'"
            }
        ],
        "datePublished": "2022-05-23T00:00:00+0000",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/dist/main.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="blog" x-bind:class="dk ? 'dark' : ''" id="top">
		<div id="rp-bar"></div>
		<div class="blogNavContainer" x-data="{ open: false }">
			<div class="blogNav">
				<div class="bannerContainer">
					<div class="bannerRow">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav navBurger">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav navItemSet">
						<a href="/posts">Posts</a>
						<a href="/tags">Tags</a>
						<a href="/about">About</a>
						<a href="/links">Useful Links</a>
						<a href="/mvp">MVP</a>
						<a href="/search">Search</a>
						<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
							<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
							<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
						</button>
						<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
							<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
						</button>
					</nav>
				</div>
			</div>
			<div class="mobileContainer">
				<div style="display:none;" class="popupBox" x-show="open" x-transition="">
					<div class="popupHead">
						<div class="popupHeadInner">
							<div class="titleRow">
								<a href="/">
									<img width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav menuRow">
								<button @click="open = false" type="button">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav popupItemsOuter">
						<nav class="gap-x-8">
							<a href="/posts">Posts</a>
							<a href="/tags">Tags</a>
							<a href="/about">About</a>
							<a href="/links">Useful Links</a>
							<a href="/mvp">MVP</a>
							<a href="/search">Search</a>
							<button x-cloak="" x-on:click="Clicked('2')" x-show="$store.theme == '1'">
								<img src="/img/Auto.png" width="32" height="32" alt="Auto" title="Automatic theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('3')" x-show="$store.theme == '2'">
								<img src="/img/Light.png" width="32" height="32" alt="Auto" title="Light theme">
							</button>
							<button x-cloak="" x-on:click="Clicked('1')" x-show="$store.theme == '3'">
								<img src="/img/Dark.png" width="32" height="32" alt="Auto" title="Dark theme">
							</button>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="headerContainer" style="">
			<div class="post-heading">
				<div class="url printBanner">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2022/xref-recent-statiq</tt>
				</div>
				<h1>
					Xref links in recent Statiq versions
				</h1>
				<h2>Something changed, and it broke my build...</h2>
				<div class="meta">Published 23 May 2022</div>
				<div class="tagList">
					<a href="/tags/statiq/">
						Statiq</a>
					<a href="/tags/general/">
						General</a>
					<span>~3 min. read</span>
				</div>
			</div>
		</header>
		<div class="blogContainerOuter">
			<div class="blogContainerInner">
				<div class="leftCol content">
					<p>I updated the build project for this blog recently, as
						<a href="https://www.statiq.dev/" target="_blank" rel="noopener">the engine used to generate</a>
						it was updated. But doing that caused an issue which I think others might bump into. So here's an explanation of what I saw and how to fix it:
						<!--more-->
					</p>
					<h2 x-data="" class="anchor">The issue
						<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading1" name="heading1">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					<p>In a couple of places in the theme for my blog I make use of
						<code>xref</code>
						links. That's a way of writing a link in your source which doesn't directly care where the resulting page will end up. The publishing code will fix-up your link to the correct URL once it's worked out where the target page is.</p>
					<p>One place I'm using these links is in the MVP widget on the right hand column. Clicking the image takes you to the relevant page. So in the
						<code>cshtml</code>
						for the right column I have a link which says:</p>
					<pre class="code" data-enlighter-language="html" style="width:100%; overflow:scroll;">&lt;a href="xref:mvp"&gt;....&lt;/a&gt;

					</pre>
					<p>and then elsewhere in the project I have a file called
						<code>mvp.md</code>
						which defines that page. And that linking had been working fine up until I updated to beta 45. Having done that, I started to see errors:</p>
					<p>
						<a target="_blank" href="/img/2022/03-ErrorsFromStatiqBuild.png">
							<img alt="A list of errors about xref resolution" src="/img/2022/03-ErrorsFromStatiqBuild.png">
						</a>
					</p>
					<p>There's basically one error here, but it's repeated a lot:</p>
					<pre class="code" data-enlighter-theme="droide" data-enlighter-language="text" style="width:100%; overflow:scroll;">[ERRO] Archives/PostProcess » ExecuteSwitch » RenderContentPostProcessTemplates » ResolveXrefs » 15 xref resolution failures:
C:/Users/jeremy.davis/source/repos/blog.jermdavis.dev/StatiqGenerator/theme/input/posts.cshtml
 - Multiple ambiguous matching documents found for xref "mvp"

					</pre>
					<p>Every time the engine is trying to render any page which has the xref link to the mvp page, it gets this error. Something that changed in beta 45 means it can no longer resolve this link correctly.</p>
					<h2 x-data="" class="anchor">Working out the cause
						<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading2" name="heading2">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					<p>The best place to start with an issue like this is with
						<a href="https://github.com/statiqdev/Statiq.Web/releases/tag/v1.0.0-beta.45" target="_blank" rel="noopener">the release notes for the new version</a>. And looking through that, there is something interesting here:</p>
					<pre class="code" data-enlighter-theme="droide" data-enlighter-language="text" style="width:100%; overflow:scroll;">Expanded xref lookup behavior to look in all relevant pipelines, not just the "content" pipeline 
(exclusions can be customized using the XrefPipelines and AdditionalXrefPipelines settings).

					</pre>
					<p>Looking through the git commits associated with this release, and thinking about that comment
						<a href="https://github.com/statiqdev/Statiq.Web/blob/4c23f91bf2b7a1e4a91ec6c45ff22ef808f9d112/src/Statiq.Web/Bootstrapper/BootstrapperExtensions.cs#L158" target="_blank" rel="noopener">lead me to this extension method</a>: (with some less relevant bits snipped out)</p>
					<pre class="code" data-enlighter-language="csharp" style="width:100%; overflow:scroll;">private static TBootstrapper AddDefaultWebSettings&lt;TBootstrapper&gt;(this TBootstrapper bootstrapper)
            where TBootstrapper : IBootstrapper =&gt;
            bootstrapper
                .AddSettingsIfNonExisting(new Dictionary&lt;string, object&gt;
                {
                    {
                        WebKeys.XrefPipelines,
                        new string[]
                        {
                            nameof(Pipelines.Content),
                            nameof(Pipelines.Assets),
                            nameof(Pipelines.Data),
                            nameof(Pipelines.Archives),
                            nameof(Pipelines.Feeds)
                        }
                    }
                });

					</pre>
					<p>The code is providing the value for a config setting as part of the bootstrap process for the Statiq engine. It's specifying a set of pipelines which are going to be processed to find potential
						<code>xref</code>
						targets. I think in the previous version of the code it only looked at the Content pipeline, but now it looks at all the main ones.</p>
					<p>So why might this break my site?</p>
					<p>It took me a while to work this out. I tried a variety of changes to my theme and content before I realised what was up. But the answer turned out to be my tags. As well as having a markdown page titled "MVP" in the content, I also had a few posts which were tagged "MVP" too. The Archives pipeline generates pages for each tag to list all the posts which have that tag applied. So you end up with HTML files for both the MVP page and for the MVP tag listing.</p>
					<p>And now that the outputs of the Archives pipeline are being considered as possible targets for an
						<code>xref</code>
						link because of the code changes in this version. And so we have an issue - because as the error says, the code can no longer decide which of the two possible matches is the right one...</p>
					<h2 x-data="" class="anchor">Possible answers
						<a title="click to copy url" x-on:click.prevent="copy($event.target)" href="#heading3" name="heading3">
							<img src="/img/link.png">
						</a>
						<span>url copied!</span>
					</h2>
					<p>I came up with ideas for how this might get sorted:</p>
					<p>
						<b>Option 1 - change the content:</b>
						Change the name of the MVP page, or the MVP tag.<br>
						Whatever they're called, as long as they both have different names, the problem will go away. Of course you'll have to remember not to accidentally cause the same issue again in the future with some other page/tag combination. So any matching combination will cause the error.</p>
					<p>
						<b>Option 2 - change the config:</b>
						Reconfigure the site to ignore the Archives pipeline.<br>
						Alternatively, do you want the xref processing to look at the output of the Archives pipeline? The config in the code above is a setting - which means it can be overridden in the Statiq config files. (Or in your code, if you're choosing to configure things that way) For example I tried adding the following to
						<code>appsettings.json</code>:</p>
					<pre class="code" data-enlighter-language="json" style="width:100%; overflow:scroll;">{
  "XrefPipelines": ["Content", "Assets", "Data", "Feeds"]
}

					</pre>
					<p>That specifies all of the pipelines except the Archives one - so the output file generated for the "MVP" tag will never be considered as a target of my
						<code>xref</code>. The down side of this is that once you exclude the archive pipeline from this config, you can't use an
						<code>xref</code>
						to refer to anything in the archives.</p>
					<p>
						<b>Option 3 - change the links:</b>
						Make your links without
						<code>xref</code>.<br>
						You could go back to using normal HTML links instead of
						<code>xref</code>. That would work fine - but it's sort of avoiding the problem.</p>
					<p>(And I suppose technically option 4 is "stay on an older version of Statiq" - but that's not a good choice)</p>
					<p>I've gone for option 2 here, and my site is generating without errors again.</p>
					<a class="gotop" href="#top">↑ Back to top</a>
					<ul class="shares">
						<li>
							<b>Feel like sharing?</b>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://bsky.app/intent/compose?text=Xref links in recent Statiq versions%20https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">On BlueSky</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">On LinkedIn</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" href="https://mastodonshare.com/?text=Xref links in recent Statiq versions&amp;url=https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">On Mastodon</a>
						</li>
						<li>⇒
							<a target="_blank" rel="nofollow noreferrer" data-no-validate="data-no-validate" href="mailto:&amp;body=Xref links in recent Statiq versions%20https://blog.jermdavis.dev/posts/2022/xref-recent-statiq">On Email</a>
						</li>
						<li></li>
					</ul>
				</div>
				<div class="rightCol sidebar">
					<div class="barContainer">
						<section class="headingSummary">
							<h3>Post Headings</h3>
							<div>
								<ol class="headings">
									<li>
										<a href="#heading1">The issue
										</a>
									</li>
									<li>
										<a href="#heading2">Working out the cause
										</a>
									</li>
									<li>
										<a href="#heading3">Possible answers
										</a>
									</li>
								</ol>
							</div>
						</section>
						<section class="mvp">
							<h3>Sitecore MVP 2015-2025</h3>
							<div>
								<a href="/mvp">
									<img class="l" src="/img/mvp/program.png" width="219" height="219" alt="2025 MVP Badge">
									<img class="d" src="/img/mvp/program_d.png" width="219" height="219" alt="2025 MVP Badge">
								</a>
							</div>
						</section>
						<section class="recentTags">
							<h3>Recent Tags</h3>
							<div>
								<a href="/tags/c/">
									C#
								</a>
								<a href="/tags/net/">
									.Net
								</a>
								<a href="/tags/bug/">
									Bug
								</a>
								<a href="/tags/general/">
									General
								</a>
								<a href="/tags/content-hub/">
									Content Hub
								</a>
								<a href="/tags/sitecore/">
									Sitecore
								</a>
								<a href="/tags/graphql/">
									GraphQL
								</a>
								<a href="/tags/sugcon/">
									SUGCON
								</a>
								<a href="/tags/xm-cloud/">
									XM Cloud
								</a>
								<a href="/tags/commerce/">
									Commerce
								</a>
							</div>
						</section>
						<section class="topTags">
							<h3>Top Tags</h3>
							<div class="list">
								<a href="/tags/sitecore/">
									Sitecore (244)</a>
								<a href="/tags/platform-dxp/">
									Platform DXP (215)</a>
								<a href="/tags/c/">
									C# (68)</a>
								<a href="/tags/powershell/">
									PowerShell (32)</a>
								<a href="/tags/installation/">
									Installation (23)</a>
								<a href="/tags/docker/">
									Docker (20)</a>
								<a href="/tags/general/">
									General (19)</a>
								<a href="/tags/solr/">
									Solr (19)</a>
								<a href="/tags/containers/">
									Containers (17)</a>
								<a href="/tags/visual-studio/">
									Visual Studio (15)</a>
							</div>
							<div class="link">
								<a href="/tags" role="button">All Tags &gt;</a>
							</div>
						</section>
						<section class="months">
							<h3>Recent Months</h3>
							<div class="list">
								<a href="/posts/2025-06">2025 - June</a>
								<a href="/posts/2025-05">2025 - May</a>
								<a href="/posts/2025-04">2025 - April</a>
								<a href="/posts/2025-03">2025 - March</a>
								<a href="/posts/2025-02">2025 - February</a>
							</div>
							<div class="link">
								<a href="/posts" role="button">All Months &gt;</a>
							</div>
						</section>
						<section class="socials">
							<h3>Socials</h3>
							<div>
								<table>
									<tbody>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													<img src="/img/bluesky.png" width="32" height="32" alt="Bluesky Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://bsky.app/profile/jermdavis.dev">
													Bluesky
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													<img src="/img/linkedin.png" width="32" height="32" alt="LinkedIn Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">
													LinkedIn
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													<img src="/img/slack.png" width="32" height="32" alt="Sitecore Slack Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://sitecorechat.slack.com/team/U73KL641G">
													Sitecore Slack
												</a>
											</td>
										</tr>
										<tr>
											<td class="icon">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													<img src="/img/mastodon.png" width="32" height="32" alt="Mastodon Logo">
												</a>
											</td>
											<td class="title">
												<a rel="me" target="_blank" href="https://mastodon.social/@jermdavis">
													Mastodon
												</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
		<footer class="footerContainer">
			<div class="copyright">
				<div>©
					<a target="_blank" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2025</div>
			</div>
			<div class="statiq">
				<a href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="feeds">
				<li>
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li>
					<a target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li>
					<a target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div x-cloak="" class="cookieContainer" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="panel">
				<div class="link">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="btn" aria-label="Dismiss">
					Understood
				</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.13.3.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script defer="" src="/vendor/rp/rpbar-1.0.js"></script>
		<script defer="" src="/js/post.js"></script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>