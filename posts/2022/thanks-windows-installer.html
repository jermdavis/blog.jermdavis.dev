<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' unpkg.com www.googletagmanager.com *.google-analytics.com; img-src 'self' data: *;style-src 'self' 'unsafe-inline'">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="canonical" href="https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">
		<meta name="description" content="If you're trying to instale Windows 10, you may have issues picking the version you need thanks to some new UI in the installer. Here's how you can work around this.">
		<meta property="og:description" content="If you're trying to instale Windows 10, you may have issues picking the version you need thanks to some new UI in the installer. Here's how you can work around this.">
		<meta name="keywords" content="Windows">
		<meta name="author" content="Jeremy Davis">
		<meta name="copyright" content="Jeremy Davis">
		<title>Jeremy Davis - Thanks Windows Installer - you could have just asked...</title>
		<meta name="robots" content="index, follow">
		<link type="application/rss+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.rss">
		<link type="application/atom+xml" rel="alternate" title="Jeremy Davis - Sitecore, C# and web development" href="/feed.atom">
		<meta name="application-name" content="Jeremy Davis">
		<meta name="msapplication-tooltip" content="Jeremy Davis">
		<meta name="msapplication-starturl" content="/">
		<link rel="manifest" href="/manifest.webmanifest">
		<meta property="og:title" content="Thanks Windows Installer - you could have just asked... [by Jeremy Davis]">
		<meta property="og:publish_date" content="2021-12-27T00:00:00+00:00">
		<meta property="og:type" content="article">
		<meta property="og:image" content="https://blog.jermdavis.dev/img/featured/thanks-windows-installer-social.jpg">
		<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "article",
        "headline": "Thanks Windows Installer - you could have just asked...",
        "url": "https://blog.jermdavis.dev/posts/2022/thanks-windows-installer",
        "image": [
            "https://blog.jermdavis.dev/img/featured/thanks-windows-installer-social.jpg"
        ],
        "datePublished": "2021-12-27T00:00:00+00:00",
        "author": [{
            "@type": "Person",
            "name": "Jeremy Davis",
            "url": "https://jermdavis.dev/"
        }]
    }
    
		</script>
		<meta property="og:url" content="https://blog.jermdavis.dev/posts/2022/thanks-windows-installer">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">
		<link href="/scss/tailwind.css" rel="stylesheet">
		<link href="/vendor/Enlighter/enlighterjs.min.css" rel="stylesheet">
		<link href="/scss/site-theme.css" rel="stylesheet">
		<script src="/vendor/Cookies/cookies.min.js" defer=""></script>
	</head>
	<body class="max-w-7xl mx-auto text-black" id="top">
		<div id="rp-bar"></div>
		<div class="relative bg-white" x-data="{ open: false }">
			
			<!-- desktop -->
			<div class="px-4 lg:px-6 bg-gray-100">
				<div class="bannerContainer flex justify-between items-center border-b-2 border-gray-100 py-6 lg:justify-start lg:space-x-10">
					<div class="flex justify-start lg:w-0 flex-1">
						<a href="/">
							<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
						</a>
						<div class="mx-2">
							<div class="text-3xl">Jeremy Davis</div>
							<div class="text-lg">Sitecore, C# and web development</div>
						</div>
					</div>
					<div class="nav -mr-2 -my-2 lg:hidden">
						<button @click="open = true" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false">
							<span class="sr-only">Open menu</span>
							
							<!-- Heroicon name: outline/menu -->
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
							</svg>
						</button>
					</div>
					<nav class="nav hidden lg:flex space-x-10">
						<a class="text-base font-medium" href="/posts">Posts</a>
						<a class="text-base font-medium" href="/tags">Tags</a>
						<a class="text-base font-medium" href="/about">About</a>
						<a class="text-base font-medium" href="/links">Useful Links</a>
						<a class="text-base font-medium" href="/mvp">MVP</a>
					</nav>
				</div>
			</div>
			
			<!--Mobile menu, show/hide based on mobile menu state.-->
			<div class="absolute top-0 inset-x-0 p-2 transition transform origin-top-right lg:hidden z-50">
				<div style="display:none;" class="rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 bg-white divide-y-2 divide-gray-50" x-show="open" x-transition="">
					<div class="pt-5 pb-6 px-5">
						<div class="flex items-center justify-between">
							<div class="flex">
								<a href="/">
									<img class="mt-2" width="56" height="56" src="/img/Profile.jpg" alt="Jeremy Davis">
								</a>
								<div class="mx-2">
									<div class="text-2xl">Jeremy Davis</div>
									<div class="text-base">Sitecore, C# and web development</div>
								</div>
							</div>
							<div class="nav -mr-2">
								<button @click="open = false" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
									<span class="sr-only">Close menu</span>
									
									<!-- Heroicon name: outline/x -->
									<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
									</svg>
								</button>
							</div>
						</div>
					</div>
					<div class="nav py-6 px-5 pt-0">
						<nav class=" gap-x-8">
							<a class="block mt-5 text-base font-medium" href="/posts">Posts</a>
							<a class="block mt-5 text-base font-medium" href="/tags">Tags</a>
							<a class="block mt-5 text-base font-medium" href="/about">About</a>
							<a class="block mt-5 text-base font-medium" href="/links">Useful Links</a>
							<a class="block mt-5 text-base font-medium" href="/mvp">MVP</a>
						</nav>
					</div>
				</div>
			</div>
		</div>
		<header class="bg-gray-300 px-4 py-1 lg:px-6 text-center" style="">
			<div class="post-heading">
				<div class="url p-1 bg-gray-100 rounded-md">Article printed from:
					<tt>https://blog.jermdavis.dev/posts/2022/thanks-windows-installer</tt>
				</div>
				<h1 class="text-5xl mb-4 pb-1">
					Thanks Windows Installer - you could have just asked...
				</h1>
				<h2 class="text-2xl">Sometimes UI 'improvements' don't actually help</h2>
				<div class="meta">Published 27 December 2021</div>
				<div class="flex py-1 flex-wrap">
					<a href="/tags/windows/" class="p-1 mr-1 mt-1 bg-gray-100 rounded-md whitespace-nowrap">
						Windows</a>
					<span class="p-1 mr-1 mt-1 bg-gray-100 rounded-md whitespace-nowrap">~3 min. read</span>
				</div>
			</div>
		</header>
		<div class="py-2 lg:pl-3">
			<div class="lg:flex">
				<div class="lg:flex-auto mx-3 lg:min-w-0 content">
					<p>One of the things I've been doing over the festive period is reinstalling some laptops. While it's usually a slightly tedious job, something Microsoft have done to the Windows Installer of late has made picking the Windows version you want harder than it should be. So I'm leaving myself a note for next time I crash into this problem... 
						<!--more-->
					</p>
					<h2>The problem</h2>
					<p>I needed to install Windows on a shiny new laptop. It had been bought with Windows Home, because there was no "I don't need to buy a new O/S" option in the shop and I already own a Windows 10 Pro license that I wanted to use on it. So it arrived with the usual bloatware installed on Home and needed wiping.</p>
					<p>So I grabbed a USB Stick, downloaded the
						<a rel="noopener" target="_blank" href="https://www.microsoft.com/en-gb/software-download/windows10">Windows Media Creation tool</a>
						and made myself a bootable Windows 10 install stick. (Yes, I am still
						<a rel="noopener" target="_blank" href="https://media.giphy.com/media/STfLOU6iRBRunMciZv/giphy.gif">actively avoiding Windows 11</a>
						for the moment) And then I went through the usualy dance of rebooting, failing to boot from USB, realising the machine ships with only "boot from SSD" enabled and fiddling with the BIOS... But after a bit of tedium I got it to boot the installer, and went through the "delete existing disk partitions" dance to clean out all the stuff that had been shipped on the laptop.</p>
					<p>Microsoft have done a bit of UX optimisation - the installer no longer asks about your license key. In fact it asks more questions about "are you ok with uploading &lt;some bit of data&gt; to Microsoft" than it does about your installation requirements these day.</p>
					<p>After a few minutes (and some annoying shouting from Cortana because the laptop's default volume was "high") it went through the install fine. But when it booted up, I noticed that it was running Windows Home. Which was not what I wanted...</p>
					<h2>What's going on?</h2>
					<p>I turns out that if you're installing with
						<a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a>
						enabled, the installer now looks into some flash memory in your computer to see if you have a built-in windows key shipped by your
						<a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Original_equipment_manufacturer">OEM</a>. Since I'd bought the laptop with Windows Home installed, that's what was in this memory.</p>
					<p>So the installer was happily assuming that was the key I wanted to use for my install, and not giving me an option to change the choice.</p>
					<p>You can see what (if any) key you have stored
						<a href="https://www.nirsoft.net/utils/product_cd_key_viewer.html" rel="noopener" target="_blank">using this viewer tool</a>
						but be aware that as I'm witing this, Windows' built-in virus protection really doesn't seem to like it. Perhaps unsurprisingly, as Microsoft might see poking about in this data as dodgy:</p>
					<p>
						<a target="_blank" href="/img/2022/12-KeyViewerError.png">
							<img src="/img/2022/12-KeyViewerError.png">
						</a>
					</p>
					<p>So you may choose not to go down that road...</p>
					<h2>Possible solutions</h2>
					<p>Having spent an hour or so trawling through google for research, there seem to be two main ways to address this issue:</p>
					<ul>
						<li>
							<p>
								<strong>You can let it install as above, and then use the "change my product key" option in Windows.</strong>
								<br>
								This will work, but it can be a bit of a hassle. Windows installs some different things for Pro compared to Home, and changing the version afterwards does not fix all of this. So if you want the full Pro experience you will need to go through the process of
								<a rel="noopener" target="_blank" href="https://support.microsoft.com/en-us/windows/how-to-refresh-reset-or-restore-your-pc-51391d9a-eb0a-84a7-69e4-c2c1fbceb8dd">reset Windows back to the fresh-install state</a>
								in order to get those extra bits.</p>
						</li>
						<li>
							<p>
								<strong>Or you can make use of the installer's ability to pick up extra "unattended install" data from your install media.</strong>
								<br>
								It is possible to put config on your install device that says "ignore what else you may see, please install Windows Pro". That will make sure all the right files are installed, and you only need to activate the right license key afterwards to get the full Pro experience.</p>
						</li>
					</ul>
					<p>To my mind, the second option here was the better one.</p>
					<p>You need to create a text file named
						<code>EI.cfg</code>
						and put it into the
						<code>sources</code>
						folder on the USB disk that the media creator set up for you. There are lots of options you can set here, using an "ini file" style format. But the key ones to get Pro vs Home are:</p>
					<pre class="code" data-enlighter-theme="droide-text" data-enlighter-language="text" style="width:100%; overflow:scroll;">[EditionID]
ProfessionalN
[Channel]
Retail
[VL]
0

					</pre>
					<p>You can also choose other versions of Windows (If you wanted the "N" version of Pro perhaps)
						<a href="https://superuser.com/questions/1020961/prevent-windows-10-installer-from-using-the-preinstalled-serial-key-without-disa/1608112#1608112" rel="noopener" target="_blank">using the advice in this Stack Exchange answer</a>.</p>
					<p>Once that file is saved, and you run through the install processs again, you'll get your chosen version. Though it still won't say anything on the screen about which version you're installing.</p>
					<p>But note that once Windows boots up, the "Activation" page in Settings may be a bit unhappy - it will know that the Home key in your BIOS memory isn't valid for the version you have installed, so you'll need to provide your valid Pro product key to allow Windows to activate. If you log in with a Microsoft Account, and you have a Pro key attached to that it may get picked up automatically. But you might need to manually enter the right key on the Activation settings page.</p>
					<p>And with that done, I was able to get back to the fun process of installing useful stuff onto these laptops, and testing out the new hardware with
						<a rel="noopener" target="_blank" href="https://store.steampowered.com/app/846770/DYSMANTLE/">a bit of festive relaxation</a>.</p>
					<a class="gotop" href="#top">↑ Back to top</a>
				</div>
				<div class="sidebar lg:flex-none lg:w-64 m-0 mt-1 lg:mt-0 lg:p-1 lg:bg-gray-100">
					<div class="md:flex-row md:flex lg:flex-col">
						<section class="md:flex-2 md:flex-grow md:flex-shrink">
							<h3 class="bg-gray-300 p-2 md:border-r-2 md:border-white lg:border-r-0">Top Tags</h3>
							<div class="bg-white p-2 flex flex-wrap">
								<a href="/tags/sitecore/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Sitecore (222)</a>
								<a href="/tags/c/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									C# (57)</a>
								<a href="/tags/powershell/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									PowerShell (31)</a>
								<a href="/tags/installation/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Installation (23)</a>
								<a href="/tags/solr/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Solr (19)</a>
								<a href="/tags/general/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									General (16)</a>
								<a href="/tags/docker/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Docker (16)</a>
								<a href="/tags/ui/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									UI (15)</a>
								<a href="/tags/containers/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Containers (14)</a>
								<a href="/tags/bug/" class="flex-initial text-lg p-1 mr-1 bg-gray-100 rounded-md mt-1">
									Bug (12)</a>
							</div>
							<div class="bg-white mb-2 p-2">
								<a class="text-lg" href="/tags" role="button">All Tags
									<i class="fas fa-angle-double-right"></i>
								</a>
							</div>
						</section>
						<section class="md:flex-2 md:border-l-2 md:border-gray-300 lg:border-l-0 md:flex-shrink-0">
							<h3 class="bg-gray-300 p-2 md:border-r-2 md:border-white lg:border-r-0">Recent Months</h3>
							<div class="bg-white p-2">
								<div>
									<a class="text-lg" href="/posts/2023-12">2023 - December</a>
								</div>
								<div>
									<a class="text-lg" href="/posts/2023-11">2023 - November</a>
								</div>
								<div>
									<a class="text-lg" href="/posts/2023-10">2023 - October</a>
								</div>
								<div>
									<a class="text-lg" href="/posts/2023-09">2023 - September</a>
								</div>
								<div>
									<a class="text-lg" href="/posts/2023-08">2023 - August</a>
								</div>
							</div>
							<div class="bg-white mb-2 p-2">
								<a class="text-lg" href="/posts" role="button">All Posts
									<i class="fas fa-angle-double-right"></i>
								</a>
							</div>
						</section>
						<section class="md:flex-1 md:border-l-2 md:border-gray-300 lg:border-l-0 md:flex-shrink">
							<h3 class="bg-gray-300 p-2 md:border-r-2 md:border-white lg:border-r-0">Socials</h3>
							<div class="bg-white mb-2 p-2">
								<div>
									<a class="text-lg" rel="me" target="_blank" href="https://mastodon.social/@jermdavis">Mastodon</a>
								</div>
								<div>
									<a class="text-lg" rel="me" target="_blank" href="https://www.linkedin.com/in/djdavis/">LinkedIn</a>
								</div>
								<div>
									<a class="text-lg" rel="me" target="_blank" href="https://twitter.com/jermdavis">Twitter</a>
								</div>
							</div>
						</section>
						<section class="mvp md:flex-2 md:border-l-2 md:border-gray-300 lg:border-l-0 md:flex-shrink-0 lg:order-first">
							<h3 class="bg-gray-300 p-2">Sitecore MVP 2015-2023</h3>
							<div class="bg-white mb-2 p-2">
								<a href="/mvp">
									<img class="lg:mx-auto" src="/img/mvp/2023.png" width="219" height="219" alt="2023 MVP Badge">
								</a>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
		<footer class="lg:flex order-1 bg-gray-100 px-4 lg:px-6 py-4">
			<div class="flex-1 lg:flex-1 text-center lg:text-left">
				<div>©
					<a target="_blank" class="font-medium" rel="noopener" href="https://jermdavis.dev/">Jeremy Davis</a>
					2014-2023</div>
			</div>
			<div class="lg:flex-1 lg:order-3 text-center lg:text-right">
				<a class="font-medium" href="/tools">Published using Statiq</a>
				<br>
			</div>
			<ul class="list-none lg:flex-1 lg:order-2 p-0 text-center lg:align-middle" style="margin:0px !important">
				<li class="inline-block">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
					</svg>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.rss">RSS</a>
				</li>
				<li class="inline-block ml-4">
					<a class="font-medium" target="_blank" href="/feed.atom">Atom</a>
				</li>
			</ul>
		</footer>
		<div class="min-h-screen bg-gray-300 py-6 flex flex-col justify-center sm:py-12" x-data="{ hide_banner: true }" x-init="hide_banner = docCookies.hasItem('hide_banner');" x-bind:class="{ 'hidden': hide_banner, 'fixed': !hide_banner }">
			<div class="border-2 border-gray-600 bg-gray-100 max-w-screen-lg mx-auto fixed bg-white inset-x-5 p-5 bottom-10 rounded-lg drop-shadow-2xl flex gap-4 flex-wrap md:flex-nowrap text-center md:text-left items-center justify-center md:justify-between">
				<div class="w-full text-lg">
					<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage" rel="noreferrer" target="_blank">This website uses Google Analytics, and its cookies.</a>
				</div>
				<button type="button" @click="hide_banner = true; docCookies.setItem('hide_banner', true, 'Fri, 31 Dec 9999 23:59:59 GMT', null, null, null, 'strict');" class="bg-gray-400 px-5 py-2 text-white rounded-md hover:bg-gray-600 focus:outline-none" aria-label="Dismiss">Understood</button>
			</div>
		</div>
		<script src="/vendor/Alpine/alpine.3.13.3.min.js" defer=""></script>
		<script src="/vendor/Enlighter/enlighterjs.min.js"></script>
		<script type="text/javascript">
            EnlighterJS.init('pre.code', 'code', {
            theme: 'droide',
            indent : 4,
            linehover : false,
            textOverflow: 'scroll',
            toolbarTop: '',
            toolbarBottom: ''
        });
        
		</script>
		<script src="/vendor/rp/rpbar-1.0.js"></script>
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JQ44ZR47YX"></script>
		<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-JQ44ZR47YX');
    
		</script>
	</body>
</html>